{"ast":null,"code":"var Promise, createRetrieverPromise, fs, nodeifyWrapper, retrieveBuffer, retrieveCombinedStream, retrieveCoreHttpStream, retrieveFilesystemStream, retrieveRequestHttpStream;\nPromise = require(\"bluebird\");\nfs = Promise.promisifyAll(require(\"fs\"));\nnodeifyWrapper = function (callback, func) {\n  return func().nodeify(callback);\n};\ncreateRetrieverPromise = function (stream, retriever) {\n  return new Promise(function (resolve, reject) {\n    return retriever(stream, function (result) {\n      if (result != null) {\n        if (result instanceof Error) {\n          return reject(result);\n        } else {\n          return resolve(result);\n        }\n      } else {\n        return reject(new Error(\"Could not find a length using this lengthRetriever.\"));\n      }\n    });\n  });\n};\nretrieveBuffer = function (stream, callback) {\n  if (stream instanceof Buffer) {\n    return callback(stream.length);\n  } else {\n    return callback(null);\n  }\n};\nretrieveFilesystemStream = function (stream, callback) {\n  var _ref;\n  if (stream.hasOwnProperty(\"fd\")) {\n    if (stream.end !== void 0 && stream.end !== Infinity && stream.start !== void 0) {\n      return callback(stream.end + 1 - ((_ref = stream.start) != null ? _ref : 0));\n    } else {\n      return Promise[\"try\"](function () {\n        return fs.statAsync(stream.path);\n      }).then(function (stat) {\n        var _ref1;\n        return callback(stat.size - ((_ref1 = stream.start) != null ? _ref1 : 0));\n      })[\"catch\"](function (err) {\n        return callback(err);\n      });\n    }\n  } else {\n    return callback(null);\n  }\n};\nretrieveCoreHttpStream = function (stream, callback) {\n  if (stream.hasOwnProperty(\"httpVersion\") && stream.headers[\"content-length\"] != null) {\n    return callback(parseInt(stream.headers[\"content-length\"]));\n  } else {\n    return callback(null);\n  }\n};\nretrieveRequestHttpStream = function (stream, callback) {\n  if (stream.hasOwnProperty(\"httpModule\")) {\n    return stream.on(\"response\", function (response) {\n      if (response.headers[\"content-length\"] != null) {\n        return callback(parseInt(response.headers[\"content-length\"]));\n      } else {\n        return callback(null);\n      }\n    });\n  } else {\n    return callback(null);\n  }\n};\nretrieveCombinedStream = function (stream, callback) {\n  if (stream.getCombinedStreamLength != null) {\n    return stream.getCombinedStreamLength().then(function (length) {\n      return callback(length);\n    })[\"catch\"](function (err) {\n      return callback(err);\n    });\n  } else {\n    return callback(null);\n  }\n};\nmodule.exports = function (stream, options, callback) {\n  if (options == null) {\n    options = {};\n  }\n  return nodeifyWrapper(callback, function () {\n    var retriever, retrieverPromises, _i, _j, _len, _len1, _ref, _ref1;\n    retrieverPromises = [];\n    if (options.lengthRetrievers != null) {\n      _ref = options.lengthRetrievers;\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        retriever = _ref[_i];\n        retrieverPromises.push(createRetrieverPromise(stream, retriever));\n      }\n    }\n    _ref1 = [retrieveBuffer, retrieveFilesystemStream, retrieveCoreHttpStream, retrieveRequestHttpStream, retrieveCombinedStream];\n    for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {\n      retriever = _ref1[_j];\n      retrieverPromises.push(createRetrieverPromise(stream, retriever));\n    }\n    return Promise.any(retrieverPromises);\n  });\n};","map":{"version":3,"names":["Promise","createRetrieverPromise","fs","nodeifyWrapper","retrieveBuffer","retrieveCombinedStream","retrieveCoreHttpStream","retrieveFilesystemStream","retrieveRequestHttpStream","require","promisifyAll","callback","func","nodeify","stream","retriever","resolve","reject","result","Error","Buffer","length","_ref","hasOwnProperty","end","Infinity","start","statAsync","path","then","stat","_ref1","size","err","headers","parseInt","on","response","getCombinedStreamLength","module","exports","options","retrieverPromises","_i","_j","_len","_len1","lengthRetrievers","push","any"],"sources":["/Users/Qusai.Qishta/node_modules/stream-length/lib/stream-length.js"],"sourcesContent":["var Promise, createRetrieverPromise, fs, nodeifyWrapper, retrieveBuffer, retrieveCombinedStream, retrieveCoreHttpStream, retrieveFilesystemStream, retrieveRequestHttpStream;\n\nPromise = require(\"bluebird\");\n\nfs = Promise.promisifyAll(require(\"fs\"));\n\nnodeifyWrapper = function(callback, func) {\n  return func().nodeify(callback);\n};\n\ncreateRetrieverPromise = function(stream, retriever) {\n  return new Promise(function(resolve, reject) {\n    return retriever(stream, function(result) {\n      if (result != null) {\n        if (result instanceof Error) {\n          return reject(result);\n        } else {\n          return resolve(result);\n        }\n      } else {\n        return reject(new Error(\"Could not find a length using this lengthRetriever.\"));\n      }\n    });\n  });\n};\n\nretrieveBuffer = function(stream, callback) {\n  if (stream instanceof Buffer) {\n    return callback(stream.length);\n  } else {\n    return callback(null);\n  }\n};\n\nretrieveFilesystemStream = function(stream, callback) {\n  var _ref;\n  if (stream.hasOwnProperty(\"fd\")) {\n    if (stream.end !== void 0 && stream.end !== Infinity && stream.start !== void 0) {\n      return callback(stream.end + 1 - ((_ref = stream.start) != null ? _ref : 0));\n    } else {\n      return Promise[\"try\"](function() {\n        return fs.statAsync(stream.path);\n      }).then(function(stat) {\n        var _ref1;\n        return callback(stat.size - ((_ref1 = stream.start) != null ? _ref1 : 0));\n      })[\"catch\"](function(err) {\n        return callback(err);\n      });\n    }\n  } else {\n    return callback(null);\n  }\n};\n\nretrieveCoreHttpStream = function(stream, callback) {\n  if (stream.hasOwnProperty(\"httpVersion\") && (stream.headers[\"content-length\"] != null)) {\n    return callback(parseInt(stream.headers[\"content-length\"]));\n  } else {\n    return callback(null);\n  }\n};\n\nretrieveRequestHttpStream = function(stream, callback) {\n  if (stream.hasOwnProperty(\"httpModule\")) {\n    return stream.on(\"response\", function(response) {\n      if (response.headers[\"content-length\"] != null) {\n        return callback(parseInt(response.headers[\"content-length\"]));\n      } else {\n        return callback(null);\n      }\n    });\n  } else {\n    return callback(null);\n  }\n};\n\nretrieveCombinedStream = function(stream, callback) {\n  if (stream.getCombinedStreamLength != null) {\n    return stream.getCombinedStreamLength().then(function(length) {\n      return callback(length);\n    })[\"catch\"](function(err) {\n      return callback(err);\n    });\n  } else {\n    return callback(null);\n  }\n};\n\nmodule.exports = function(stream, options, callback) {\n  if (options == null) {\n    options = {};\n  }\n  return nodeifyWrapper(callback, function() {\n    var retriever, retrieverPromises, _i, _j, _len, _len1, _ref, _ref1;\n    retrieverPromises = [];\n    if (options.lengthRetrievers != null) {\n      _ref = options.lengthRetrievers;\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        retriever = _ref[_i];\n        retrieverPromises.push(createRetrieverPromise(stream, retriever));\n      }\n    }\n    _ref1 = [retrieveBuffer, retrieveFilesystemStream, retrieveCoreHttpStream, retrieveRequestHttpStream, retrieveCombinedStream];\n    for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {\n      retriever = _ref1[_j];\n      retrieverPromises.push(createRetrieverPromise(stream, retriever));\n    }\n    return Promise.any(retrieverPromises);\n  });\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}