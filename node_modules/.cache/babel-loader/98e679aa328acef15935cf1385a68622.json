{"ast":null,"code":"'use strict';\n\nvar tls = require('tls');\nvar http = require('http');\nvar https = require('https');\nvar url = require('url');\nvar util = require('util');\nvar stream = require('stream');\nvar zlib = require('zlib');\nvar aws2 = require('aws-sign2');\nvar aws4 = require('aws4');\nvar uuid = require('uuid/v4');\nvar httpSignature = require('http-signature');\nvar mime = require('mime-types');\nvar caseless = require('caseless');\nvar ForeverAgent = require('forever-agent');\nvar FormData = require('@postman/form-data');\nvar extend = require('extend');\nvar isstream = require('isstream');\nvar streamLength = require('stream-length');\nvar isTypedArray = require('is-typedarray').strict;\nvar helpers = require('./lib/helpers');\nvar cookies = require('./lib/cookies');\nvar getProxyFromURI = require('./lib/getProxyFromURI');\nvar Querystring = require('./lib/querystring').Querystring;\nvar Har = require('./lib/har').Har;\nvar Auth = require('./lib/auth').Auth;\nvar OAuth = require('./lib/oauth').OAuth;\nvar hawk = require('./lib/hawk');\nvar Multipart = require('./lib/multipart').Multipart;\nvar Redirect = require('./lib/redirect').Redirect;\nvar Tunnel = require('./lib/tunnel').Tunnel;\nvar now = require('performance-now');\nvar Buffer = require('safe-buffer').Buffer;\nvar inflate = require('./lib/inflate');\nvar brotli = require('./lib/brotli');\nvar urlParse = require('./lib/url-parse');\nvar safeStringify = helpers.safeStringify;\nvar isReadStream = helpers.isReadStream;\nvar toBase64 = helpers.toBase64;\nvar defer = helpers.defer;\nvar copy = helpers.copy;\nvar version = helpers.version;\nvar globalCookieJar = cookies.jar();\nvar globalPool = {};\nfunction filterForNonReserved(reserved, options) {\n  // Filter out properties that are not reserved.\n  // Reserved values are passed in at call site.\n\n  var object = {};\n  for (var i in options) {\n    var notReserved = reserved.indexOf(i) === -1;\n    if (notReserved) {\n      object[i] = options[i];\n    }\n  }\n  return object;\n}\nfunction filterOutReservedFunctions(reserved, options) {\n  // Filter out properties that are functions and are reserved.\n  // Reserved values are passed in at call site.\n\n  var object = {};\n  for (var i in options) {\n    var isReserved = !(reserved.indexOf(i) === -1);\n    var isFunction = typeof options[i] === 'function';\n    if (!(isReserved && isFunction)) {\n      object[i] = options[i];\n    }\n  }\n  return object;\n}\nfunction transformFormData(formData) {\n  // Transform the object representation of form-data fields to array representation.\n  // This might not preserve the order of form fields defined in object representation.\n  // But, this transformation is required to support backward compatibility.\n  //\n  // Form-Data should be stored as an array to respect the fields order.\n  // RFC 7578#section-5.2  Ordered Fields and Duplicated Field Names\n  // https://tools.ietf.org/html/rfc7578#section-5.2\n\n  var transformedFormData = [];\n  var appendFormParam = function (key, param) {\n    transformedFormData.push({\n      key: key,\n      value: param && param.hasOwnProperty('value') ? param.value : param,\n      options: param && param.hasOwnProperty('options') ? param.options : undefined\n    });\n  };\n  for (var formKey in formData) {\n    if (formData.hasOwnProperty(formKey)) {\n      var formValue = formData[formKey];\n      if (Array.isArray(formValue)) {\n        for (var j = 0; j < formValue.length; j++) {\n          appendFormParam(formKey, formValue[j]);\n        }\n      } else {\n        appendFormParam(formKey, formValue);\n      }\n    }\n  }\n  return transformedFormData;\n}\n\n// Return a simpler request object to allow serialization\nfunction requestToJSON() {\n  var self = this;\n  return {\n    uri: self.uri,\n    method: self.method,\n    headers: self.headers\n  };\n}\n\n// Return a simpler response object to allow serialization\nfunction responseToJSON() {\n  var self = this;\n  return {\n    statusCode: self.statusCode,\n    body: self.body,\n    headers: self.headers,\n    request: requestToJSON.call(self.request)\n  };\n}\n\n/**\n * Return request headers in [{key: headerName, value: headerValue}] form\n * @param {String} [headerString] - headers string created by Node stored in ClientRequest._header\n *\n * */\nfunction parseRequestHeaders(headerString) {\n  var arr = headerString.split('\\r\\n');\n  var acc = [];\n\n  // first element of accumulator is not a header\n  // last two elements are empty strings\n  for (var i = 1; i < arr.length - 2; i++) {\n    // header name cannot have a ':' but header value allows it\n    // therefore we split on the index of the first ':'\n    var splitIndex = arr[i].indexOf(':');\n    acc.push({\n      key: arr[i].slice(0, splitIndex),\n      value: arr[i].slice(splitIndex + 2)\n    });\n  }\n  return acc;\n}\n\n/**\n * Return response headers in [{key: headerName, value: headerValue}] form\n * @param {Array} [rawHeaders] - https://nodejs.org/api/http.html#http_message_rawheaders\n *\n * */\nfunction parseResponseHeaders(rawHeaders) {\n  var acc = [];\n  for (var i = 0; i < rawHeaders.length; i = i + 2) {\n    acc.push({\n      key: rawHeaders[i],\n      value: rawHeaders[i + 1]\n    });\n  }\n  return acc;\n}\nfunction Request(options) {\n  // if given the method property in options, set property explicitMethod to true\n\n  // extend the Request instance with any non-reserved properties\n  // remove any reserved functions from the options object\n  // set Request instance to be readable and writable\n  // call init\n\n  var self = this;\n\n  // start with HAR, then override with additional options\n  if (options.har) {\n    self._har = new Har(self);\n    options = self._har.options(options);\n  }\n\n  // transform `formData` for backward compatibility\n  // don't check for explicit object type to support legacy shenanigans\n  if (options.formData && !Array.isArray(options.formData)) {\n    options.formData = transformFormData(options.formData);\n  }\n\n  // use custom URL parser if provided, fallback to url.parse and url.resolve\n  if (!(options.urlParser && typeof options.urlParser.parse === 'function' && typeof options.urlParser.resolve === 'function')) {\n    options.urlParser = {\n      parse: url.parse,\n      resolve: url.resolve\n    };\n  }\n  stream.Stream.call(self);\n  var reserved = Object.keys(Request.prototype);\n  var nonReserved = filterForNonReserved(reserved, options);\n  extend(self, nonReserved);\n  options = filterOutReservedFunctions(reserved, options);\n  self.readable = true;\n  self.writable = true;\n  self._debug = [];\n  if (options.method) {\n    self.explicitMethod = true;\n  }\n  self._qs = new Querystring(self);\n  self._auth = new Auth(self);\n  self._oauth = new OAuth(self);\n  self._multipart = new Multipart(self);\n  self._redirect = new Redirect(self);\n  self._tunnel = new Tunnel(self);\n  self.init(options);\n}\nutil.inherits(Request, stream.Stream);\n\n// Debugging\nRequest.debug = process.env.NODE_DEBUG && /\\brequest\\b/.test(process.env.NODE_DEBUG);\nfunction debug() {\n  if (Request.debug) {\n    console.error('REQUEST %s', util.format.apply(util, arguments));\n  }\n}\nRequest.prototype.debug = debug;\nRequest.prototype.init = function (options) {\n  // init() contains all the code to setup the request object.\n  // the actual outgoing request is not started until start() is called\n  // this function is called from both the constructor and on redirect.\n  var self = this;\n  if (!options) {\n    options = {};\n  }\n  self.headers = self.headers ? copy(self.headers) : {};\n\n  // for this request (or redirect) store its debug logs in `_reqResInfo` and\n  // store its reference in `_debug` which holds debug logs of every request\n  self._reqResInfo = {};\n  self._debug.push(self._reqResInfo);\n\n  // additional postman feature starts\n  // bind default events sent via options\n  if (options.bindOn) {\n    Object.keys(options.bindOn).forEach(function (eventName) {\n      !Array.isArray(options.bindOn[eventName]) && (options.bindOn[eventName] = [options.bindOn[eventName]]);\n      options.bindOn[eventName].forEach(function (listener) {\n        self.on(eventName, listener);\n      });\n    });\n  }\n  if (options.once) {\n    Object.keys(options.once).forEach(function (eventName) {\n      !Array.isArray(options.bindOnce[eventName]) && (options.bindOnce[eventName] = [options.bindOnce[eventName]]);\n      options.bindOnce[eventName].forEach(function (listener) {\n        self.once(eventName, listener);\n      });\n    });\n  }\n  // additional postman feature ends\n\n  // Delete headers with value undefined since they break\n  // ClientRequest.OutgoingMessage.setHeader in node 0.12\n  for (var headerName in self.headers) {\n    if (typeof self.headers[headerName] === 'undefined') {\n      delete self.headers[headerName];\n    }\n  }\n  caseless.httpify(self, self.headers);\n  if (!self.method) {\n    self.method = options.method || 'GET';\n  }\n  if (!self.localAddress) {\n    self.localAddress = options.localAddress;\n  }\n  self._qs.init(options);\n  debug(options);\n  if (!self.pool && self.pool !== false) {\n    self.pool = globalPool;\n  }\n  self.dests = self.dests || [];\n  self.__isRequestRequest = true;\n\n  // Protect against double callback\n  if (!self._callback && self.callback) {\n    self._callback = self.callback;\n    self.callback = function (error, response, body) {\n      if (self._callbackCalled) {\n        return; // Print a warning maybe?\n      }\n\n      self._callbackCalled = true;\n      self._callback(error, response, body, self._debug);\n    };\n    self.on('error', self.callback.bind());\n    self.on('complete', self.callback.bind(self, null));\n  }\n\n  // People use this property instead all the time, so support it\n  if (!self.uri && self.url) {\n    self.uri = self.url;\n    delete self.url;\n  }\n\n  // If there's a baseUrl, then use it as the base URL (i.e. uri must be\n  // specified as a relative path and is appended to baseUrl).\n  if (self.baseUrl) {\n    if (typeof self.baseUrl !== 'string') {\n      return self.emit('error', new Error('options.baseUrl must be a string'));\n    }\n    if (typeof self.uri !== 'string') {\n      return self.emit('error', new Error('options.uri must be a string when using options.baseUrl'));\n    }\n    if (self.uri.indexOf('//') === 0 || self.uri.indexOf('://') !== -1) {\n      return self.emit('error', new Error('options.uri must be a path when using options.baseUrl'));\n    }\n\n    // Handle all cases to make sure that there's only one slash between\n    // baseUrl and uri.\n    var baseUrlEndsWithSlash = self.baseUrl.lastIndexOf('/') === self.baseUrl.length - 1;\n    var uriStartsWithSlash = self.uri.indexOf('/') === 0;\n    if (baseUrlEndsWithSlash && uriStartsWithSlash) {\n      self.uri = self.baseUrl + self.uri.slice(1);\n    } else if (baseUrlEndsWithSlash || uriStartsWithSlash) {\n      self.uri = self.baseUrl + self.uri;\n    } else if (self.uri === '') {\n      self.uri = self.baseUrl;\n    } else {\n      self.uri = self.baseUrl + '/' + self.uri;\n    }\n    delete self.baseUrl;\n  }\n\n  // A URI is needed by this point, emit error if we haven't been able to get one\n  if (!self.uri) {\n    return self.emit('error', new Error('options.uri is a required argument'));\n  }\n\n  // If a string URI/URL was given, parse it into a URL object\n  if (typeof self.uri === 'string') {\n    self.uri = self.urlParser.parse(self.uri);\n  }\n\n  // Some URL objects are not from a URL parsed string and need href added\n  if (!self.uri.href) {\n    self.uri.href = url.format(self.uri);\n  }\n\n  // DEPRECATED: Warning for users of the old Unix Sockets URL Scheme\n  if (self.uri.protocol === 'unix:') {\n    return self.emit('error', new Error('`unix://` URL scheme is no longer supported. Please use the format `http://unix:SOCKET:PATH`'));\n  }\n\n  // Support Unix Sockets\n  if (self.uri.host === 'unix') {\n    self.enableUnixSocket();\n  }\n  if (self.strictSSL === false) {\n    self.rejectUnauthorized = false;\n  }\n  if (!self.uri.pathname) {\n    self.uri.pathname = '/';\n  }\n  if (!(self.uri.host || self.uri.hostname && self.uri.port) && !self.uri.isUnix) {\n    // Invalid URI: it may generate lot of bad errors, like 'TypeError: Cannot call method `indexOf` of undefined' in CookieJar\n    // Detect and reject it as soon as possible\n    var faultyUri = url.format(self.uri);\n    var message = 'Invalid URI \"' + faultyUri + '\"';\n    if (Object.keys(options).length === 0) {\n      // No option ? This can be the sign of a redirect\n      // As this is a case where the user cannot do anything (they didn't call request directly with this URL)\n      // they should be warned that it can be caused by a redirection (can save some hair)\n      message += '. This can be caused by a crappy redirection.';\n    }\n    // This error was fatal\n    self.abort();\n    return self.emit('error', new Error(message));\n  }\n  if (!self.hasOwnProperty('proxy')) {\n    self.proxy = getProxyFromURI(self.uri);\n  }\n  if (typeof self.proxy === 'string') {\n    self.proxy = self.urlParser.parse(self.proxy);\n    if (self.proxy.auth) {\n      self.proxy.auth = self._qs.unescape(self.proxy.auth);\n    }\n  }\n  self.tunnel = self._tunnel.isEnabled();\n  if (self.proxy) {\n    self._tunnel.setup(options);\n  }\n  self._redirect.onRequest(options);\n\n  // Add `Host` header if not defined already\n  self.setHost = self.setHost === undefined || Boolean(self.setHost);\n  if (!self.hasHeader('host') && self.setHost) {\n    var hostHeaderName = self.originalHostHeaderName || 'Host';\n    self.setHeader(hostHeaderName, self.uri.host);\n    // Drop :port suffix from Host header if known protocol.\n    if (self.uri.port) {\n      if (self.uri.port === '80' && self.uri.protocol === 'http:' || self.uri.port === '443' && self.uri.protocol === 'https:') {\n        self.setHeader(hostHeaderName, self.uri.hostname);\n      }\n    }\n  }\n  if (!self.uri.port) {\n    if (self.uri.protocol === 'http:') {\n      self.uri.port = 80;\n    } else if (self.uri.protocol === 'https:') {\n      self.uri.port = 443;\n    }\n  }\n  if (self.proxy && !self.tunnel) {\n    self.port = self.proxy.port;\n    self.host = self.proxy.hostname;\n  } else {\n    self.port = self.uri.port;\n    self.host = self.uri.hostname;\n  }\n  if (options.form) {\n    self.form(options.form);\n  }\n  if (options.formData) {\n    var formData = options.formData;\n    var requestForm = self.form();\n    for (var i = 0, ii = formData.length; i < ii; i++) {\n      var formParam = formData[i];\n      if (!formParam) {\n        continue;\n      }\n      if (formParam.options) {\n        requestForm.append(formParam.key, formParam.value, formParam.options);\n      } else {\n        requestForm.append(formParam.key, formParam.value);\n      }\n    }\n  }\n  if (options.qs) {\n    self.qs(options.qs);\n  }\n  if (self.uri.path) {\n    self.path = self.uri.path;\n  } else {\n    self.path = self.uri.pathname + (self.uri.search || '');\n  }\n  if (self.path.length === 0) {\n    self.path = '/';\n  }\n\n  // Auth must happen last in case signing is dependent on other headers\n  if (options.aws) {\n    self.aws(options.aws);\n  }\n  if (options.hawk) {\n    self.hawk(options.hawk);\n  }\n  if (options.httpSignature) {\n    self.httpSignature(options.httpSignature);\n  }\n  if (options.auth) {\n    if (Object.prototype.hasOwnProperty.call(options.auth, 'username')) {\n      options.auth.user = options.auth.username;\n    }\n    if (Object.prototype.hasOwnProperty.call(options.auth, 'password')) {\n      options.auth.pass = options.auth.password;\n    }\n    self.auth(options.auth.user, options.auth.pass, options.auth.sendImmediately, options.auth.bearer);\n  }\n  if (!self.hasHeader('accept-encoding')) {\n    var acceptEncoding = '';\n    self.gzip && (acceptEncoding += 'gzip, deflate');\n    if (self.brotli) {\n      acceptEncoding && (acceptEncoding += ', ');\n      acceptEncoding += 'br';\n    }\n    acceptEncoding && self.setHeader('Accept-Encoding', acceptEncoding);\n  }\n  if (self.uri.auth && !self.hasHeader('authorization')) {\n    var uriAuthPieces = self.uri.auth.split(':').map(function (item) {\n      return self._qs.unescape(item);\n    });\n    self.auth(uriAuthPieces[0], uriAuthPieces.slice(1).join(':'), true);\n  }\n  if (!self.tunnel && self.proxy && self.proxy.auth && !self.hasHeader('proxy-authorization')) {\n    self.setHeader('Proxy-Authorization', 'Basic ' + toBase64(self.proxy.auth));\n  }\n  if (self.proxy && !self.tunnel) {\n    self.path = self.uri.protocol + '//' + self.uri.host + self.path;\n  }\n  if (options.json) {\n    self.json(options.json);\n  }\n  if (options.multipart) {\n    self.multipart(options.multipart);\n  }\n\n  // enable timings if verbose is true\n  if (options.time || options.verbose) {\n    self.timing = true;\n\n    // NOTE: elapsedTime is deprecated in favor of .timings\n    self.elapsedTime = self.elapsedTime || 0;\n  }\n  if (options.verbose) {\n    self.verbose = true;\n  }\n  if (typeof options.maxResponseSize === 'number') {\n    self.maxResponseSize = options.maxResponseSize;\n  }\n  function setContentLength() {\n    if (isTypedArray(self.body)) {\n      self.body = Buffer.from(self.body);\n    }\n    if (!self.hasHeader('content-length')) {\n      var length;\n      if (typeof self.body === 'string') {\n        length = Buffer.byteLength(self.body);\n      } else if (Array.isArray(self.body)) {\n        length = self.body.reduce(function (a, b) {\n          return a + b.length;\n        }, 0);\n      } else {\n        length = self.body.length;\n      }\n      if (length) {\n        self.setHeader('Content-Length', length);\n      } else {\n        self.emit('error', new Error('Argument error, options.body.'));\n      }\n    }\n  }\n  if (self.body && !isstream(self.body)) {\n    setContentLength();\n  }\n  if (options.oauth) {\n    self.oauth(options.oauth);\n  } else if (self._oauth.params && self.hasHeader('authorization')) {\n    self.oauth(self._oauth.params);\n  }\n  var protocol = self.proxy && !self.tunnel ? self.proxy.protocol : self.uri.protocol;\n  var defaultModules = {\n    'http:': http,\n    'https:': https\n  };\n  var httpModules = self.httpModules || {};\n  self.httpModule = httpModules[protocol] || defaultModules[protocol];\n  if (!self.httpModule) {\n    return self.emit('error', new Error('Invalid protocol: ' + protocol));\n  }\n  if (options.ca) {\n    self.ca = options.ca;\n  }\n\n  // prefer common self.agent if exists\n  if (self.agents && !self.agent) {\n    var agent = protocol === 'http:' ? self.agents.http : self.agents.https;\n    if (agent) {\n      if (agent.agentClass || agent.agentOptions) {\n        options.agentClass = agent.agentClass || options.agentClass;\n        options.agentOptions = agent.agentOptions || options.agentOptions;\n      } else {\n        self.agent = agent;\n      }\n    }\n  }\n  if (!self.agent) {\n    if (options.agentOptions) {\n      self.agentOptions = options.agentOptions;\n    }\n    if (options.agentClass) {\n      self.agentClass = options.agentClass;\n    } else if (options.forever) {\n      var v = version();\n      // use ForeverAgent in node 0.10- only\n      if (v.major === 0 && v.minor <= 10) {\n        self.agentClass = protocol === 'http:' ? ForeverAgent : ForeverAgent.SSL;\n      } else {\n        self.agentClass = self.httpModule.Agent;\n        self.agentOptions = self.agentOptions || {};\n        self.agentOptions.keepAlive = true;\n      }\n    } else {\n      self.agentClass = self.httpModule.Agent;\n    }\n  }\n  if (self.pool === false) {\n    self.agent = false;\n  } else {\n    self.agent = self.agent || self.getNewAgent();\n  }\n  self.on('pipe', function (src) {\n    if (self.ntick && self._started) {\n      self.emit('error', new Error('You cannot pipe to this stream after the outbound request has started.'));\n    }\n    self.src = src;\n    if (isReadStream(src)) {\n      if (!self.hasHeader('content-type')) {\n        // @note fallback to 'application/octet-stream' if mime.lookup returns `false`\n        self.setHeader('Content-Type', mime.lookup(src.path) || 'application/octet-stream');\n      }\n    } else {\n      if (src.headers) {\n        for (var i in src.headers) {\n          if (!self.hasHeader(i)) {\n            self.setHeader(i, src.headers[i]);\n          }\n        }\n      }\n      if (self._json && !self.hasHeader('content-type')) {\n        self.setHeader('Content-Type', 'application/json');\n      }\n      if (src.method && !self.explicitMethod) {\n        self.method = src.method;\n      }\n    }\n\n    // self.on('pipe', function () {\n    //   console.error('You have already piped to this stream. Pipeing twice is likely to break the request.')\n    // })\n  });\n\n  defer(function () {\n    if (self._aborted) {\n      return;\n    }\n    var end = function () {\n      if (self._form) {\n        if (!self._auth.hasAuth || self._auth.hasAuth && self._auth.sentAuth) {\n          try {\n            self._form.pipe(self);\n          } catch (err) {\n            self.abort();\n            options.callback && options.callback(err);\n            return;\n          }\n        }\n      }\n      if (self._multipart && self._multipart.chunked) {\n        self._multipart.body.pipe(self);\n      }\n      if (self.body) {\n        if (isstream(self.body)) {\n          if (self.hasHeader('content-length')) {\n            self.body.pipe(self);\n          } else {\n            // certain servers require content-length to function. we try to pre-detect if possible\n            streamLength(self.body, {}, function (err, len) {\n              if (!(err || self._started || self.hasHeader('content-length') || len === null || len < 0)) {\n                self.setHeader('Content-Length', len);\n              }\n              self.body.pipe(self);\n            });\n          }\n        } else {\n          setContentLength();\n          if (Array.isArray(self.body)) {\n            self.body.forEach(function (part) {\n              self.write(part);\n            });\n          } else {\n            self.write(self.body);\n          }\n          self.end();\n        }\n      } else if (self.requestBodyStream) {\n        console.warn('options.requestBodyStream is deprecated, please pass the request object to stream.pipe.');\n        self.requestBodyStream.pipe(self);\n      } else if (!self.src) {\n        if (self._auth.hasAuth && !self._auth.sentAuth || self.hasHeader('content-length')) {\n          self.end();\n          return;\n        }\n        switch (self.method) {\n          case 'GET':\n          case 'HEAD':\n          case 'TRACE':\n          case 'DELETE':\n          case 'CONNECT':\n          case 'OPTIONS':\n          case undefined:\n            // @note this behavior is same as Node.js\n            break;\n          default:\n            self.setHeader('Content-Length', 0);\n            break;\n        }\n        self.end();\n      }\n    };\n    self.jar(self._jar || options.jar, function () {\n      if (self._form && !self.hasHeader('content-length')) {\n        // Before ending the request, we had to compute the length of the whole form, asyncly\n        self._form.getLength(function (err, length) {\n          if (!err && !isNaN(length)) {\n            self.setHeader('Content-Length', length);\n          }\n          end();\n        });\n      } else {\n        end();\n      }\n    });\n    self.ntick = true;\n  });\n};\nRequest.prototype.getNewAgent = function () {\n  var self = this;\n  var Agent = self.agentClass;\n  var options = {};\n  if (self.agentOptions) {\n    for (var i in self.agentOptions) {\n      options[i] = self.agentOptions[i];\n    }\n  }\n  if (self.ca) {\n    options.ca = self.ca;\n  }\n  if (self.extraCA) {\n    options.extraCA = self.extraCA;\n  }\n  if (self.ciphers) {\n    options.ciphers = self.ciphers;\n  }\n  if (self.secureProtocol) {\n    options.secureProtocol = self.secureProtocol;\n  }\n  if (self.secureOptions) {\n    options.secureOptions = self.secureOptions;\n  }\n  if (typeof self.rejectUnauthorized !== 'undefined') {\n    options.rejectUnauthorized = self.rejectUnauthorized;\n  }\n  if (self.cert && self.key) {\n    options.key = self.key;\n    options.cert = self.cert;\n  }\n  if (self.pfx) {\n    options.pfx = self.pfx;\n  }\n  if (self.passphrase) {\n    options.passphrase = self.passphrase;\n  }\n  var poolKey = '';\n\n  // different types of agents are in different pools\n  if (Agent !== self.httpModule.Agent) {\n    poolKey += Agent.name;\n  }\n\n  // ca option is only relevant if proxy or destination are https\n  var proxy = self.proxy;\n  if (typeof proxy === 'string') {\n    proxy = self.urlParser.parse(proxy);\n  }\n  var isHttps = proxy && proxy.protocol === 'https:' || this.uri.protocol === 'https:';\n  if (isHttps) {\n    if (options.ca) {\n      if (poolKey) {\n        poolKey += ':';\n      }\n      poolKey += options.ca;\n    }\n\n    // only add when NodeExtraCACerts is enabled\n    if (tls.__createSecureContext && options.extraCA) {\n      if (poolKey) {\n        poolKey += ':';\n      }\n      poolKey += options.extraCA;\n    }\n    if (typeof options.rejectUnauthorized !== 'undefined') {\n      if (poolKey) {\n        poolKey += ':';\n      }\n      poolKey += options.rejectUnauthorized;\n    }\n    if (options.cert) {\n      if (poolKey) {\n        poolKey += ':';\n      }\n      poolKey += options.cert.toString('ascii') + options.key.toString('ascii');\n    }\n    if (options.pfx) {\n      if (poolKey) {\n        poolKey += ':';\n      }\n      poolKey += options.pfx.toString('ascii');\n    }\n    if (options.passphrase) {\n      if (poolKey) {\n        poolKey += ':';\n      }\n      poolKey += options.passphrase;\n    }\n    if (options.ciphers) {\n      if (poolKey) {\n        poolKey += ':';\n      }\n      poolKey += options.ciphers;\n    }\n    if (options.secureProtocol) {\n      if (poolKey) {\n        poolKey += ':';\n      }\n      poolKey += options.secureProtocol;\n    }\n    if (options.secureOptions) {\n      if (poolKey) {\n        poolKey += ':';\n      }\n      poolKey += options.secureOptions;\n    }\n  }\n  if (self.pool === globalPool && !poolKey && Object.keys(options).length === 0 && self.httpModule.globalAgent) {\n    // not doing anything special.  Use the globalAgent\n    return self.httpModule.globalAgent;\n  }\n\n  // we're using a stored agent.  Make sure it's protocol-specific\n  poolKey = self.uri.protocol + poolKey;\n\n  // generate a new agent for this setting if none yet exists\n  if (!self.pool[poolKey]) {\n    self.pool[poolKey] = new Agent(options);\n    // properly set maxSockets on new agents\n    if (self.pool.maxSockets) {\n      self.pool[poolKey].maxSockets = self.pool.maxSockets;\n    }\n  }\n  return self.pool[poolKey];\n};\nRequest.prototype.start = function () {\n  // start() is called once we are ready to send the outgoing HTTP request.\n  // this is usually called on the first write(), end() or on nextTick()\n  var self = this;\n  if (self.timing) {\n    // All timings will be relative to this request's startTime.  In order to do this,\n    // we need to capture the wall-clock start time (via Date), immediately followed\n    // by the high-resolution timer (via now()).  While these two won't be set\n    // at the _exact_ same time, they should be close enough to be able to calculate\n    // high-resolution, monotonically non-decreasing timestamps relative to startTime.\n    var startTime = new Date().getTime();\n    var startTimeNow = now();\n  }\n  if (self._aborted) {\n    return;\n  }\n\n  // postman: emit start event\n  self.emit('start');\n  self._started = true;\n  self.method = self.method || 'GET';\n  self.href = self.uri.href;\n  if (self.src && self.src.stat && self.src.stat.size && !self.hasHeader('content-length')) {\n    self.setHeader('Content-Length', self.src.stat.size);\n  }\n  if (self._aws) {\n    self.aws(self._aws, true);\n  }\n  self._reqResInfo.request = {\n    method: self.method,\n    href: self.uri.href,\n    headers: [],\n    proxy: self.proxy && {\n      href: self.proxy.href\n    } || undefined,\n    httpVersion: '1.1'\n  };\n\n  // We have a method named auth, which is completely different from the http.request\n  // auth option.  If we don't remove it, we're gonna have a bad time.\n  var reqOptions = copy(self);\n  delete reqOptions.auth;\n\n  // Workaround for a bug in Node: https://github.com/nodejs/node/issues/8321\n  if (!(self.disableUrlEncoding || self.proxy || self.uri.isUnix)) {\n    try {\n      extend(reqOptions, urlParse(self.uri.href));\n    } catch (e) {} // nothing to do if urlParse fails, \"extend\" never throws an error.\n  }\n\n  debug('make request', self.uri.href);\n\n  // node v6.8.0 now supports a `timeout` value in `http.request()`, but we\n  // should delete it for now since we handle timeouts manually for better\n  // consistency with node versions before v6.8.0\n  delete reqOptions.timeout;\n  try {\n    self.req = self.httpModule.request(reqOptions);\n\n    // Remove blacklisted headers from the request instance.\n    // @note don't check for `hasHeader` because headers like `connection`,\n    // 'content-length', 'transfer-encoding' etc. are added at the very end\n    // and `removeHeader` updates the Node.js internal state which makes sure\n    // these headers are not added.\n    if (Array.isArray(self.blacklistHeaders) && self.blacklistHeaders.length) {\n      self.blacklistHeaders.forEach(function (header) {\n        self.req.removeHeader(header);\n        // also remove from the `self` for the consistency\n        self.removeHeader(header);\n      });\n    }\n  } catch (err) {\n    self.emit('error', err);\n    return;\n  }\n  if (self.timing) {\n    self.startTime = startTime;\n    self.startTimeNow = startTimeNow;\n\n    // Timing values will all be relative to startTime (by comparing to startTimeNow\n    // so we have an accurate clock)\n    self.timings = {};\n  }\n  var timeout;\n  if (self.timeout && !self.timeoutTimer) {\n    if (self.timeout < 0) {\n      timeout = 0;\n    } else if (typeof self.timeout === 'number' && isFinite(self.timeout)) {\n      timeout = self.timeout;\n    }\n  }\n  self.req.on('response', self.onRequestResponse.bind(self));\n  self.req.on('error', self.onRequestError.bind(self));\n  self.req.on('drain', function () {\n    self.emit('drain');\n  });\n  self.req.on('socket', function (socket) {\n    if (self.verbose) {\n      // The reused socket holds all the session data which was injected in\n      // during the first connection. This is done because events like\n      // `lookup`, `connect` & `secureConnect` will not be triggered for a\n      // reused socket and debug information will be lost for that request.\n      var reusedSocket = Boolean(socket.__SESSION_ID && socket.__SESSION_DATA);\n      if (!reusedSocket) {\n        socket.__SESSION_ID = uuid();\n        socket.__SESSION_DATA = {};\n      }\n\n      // @note make sure you don't serialize this object to avoid memory leak\n      self._reqResInfo.session = {\n        id: socket.__SESSION_ID,\n        reused: reusedSocket,\n        data: socket.__SESSION_DATA\n      };\n    }\n\n    // `._connecting` was the old property which was made public in node v6.1.0\n    var isConnecting = socket._connecting || socket.connecting;\n    if (self.timing) {\n      self.timings.socket = now() - self.startTimeNow;\n      if (isConnecting) {\n        var onLookupTiming = function () {\n          self.timings.lookup = now() - self.startTimeNow;\n        };\n        var onConnectTiming = function () {\n          self.timings.connect = now() - self.startTimeNow;\n          if (self.verbose) {\n            socket.__SESSION_DATA.addresses = {\n              // local address\n              // @note there's no `socket.localFamily` but `.address` method\n              // returns same output as of remote.\n              local: typeof socket.address === 'function' && socket.address(),\n              // remote address\n              remote: {\n                address: socket.remoteAddress,\n                family: socket.remoteFamily,\n                port: socket.remotePort\n              }\n            };\n          }\n        };\n        var onSecureConnectTiming = function () {\n          self.timings.secureConnect = now() - self.startTimeNow;\n          if (self.verbose) {\n            socket.__SESSION_DATA.tls = {\n              // true if the session was reused\n              reused: typeof socket.isSessionReused === 'function' && socket.isSessionReused(),\n              // true if the peer certificate was signed by one of the CAs specified\n              authorized: socket.authorized,\n              // reason why the peer's certificate was not been verified\n              authorizationError: socket.authorizationError,\n              // negotiated cipher name\n              cipher: typeof socket.getCipher === 'function' && socket.getCipher(),\n              // negotiated SSL/TLS protocol version\n              // @note Node >= v5.7.0\n              protocol: typeof socket.getProtocol === 'function' && socket.getProtocol(),\n              // type, name, and size of parameter of an ephemeral key exchange\n              // @note Node >= v5.0.0\n              ephemeralKeyInfo: typeof socket.getEphemeralKeyInfo === 'function' && socket.getEphemeralKeyInfo()\n            };\n\n            // peer certificate information\n            // @note if session is reused, all certificate information is\n            // stripped from the socket (returns {}).\n            // Refer: https://github.com/nodejs/node/issues/3940\n            var peerCert = typeof socket.getPeerCertificate === 'function' && (socket.getPeerCertificate() || {});\n            socket.__SESSION_DATA.tls.peerCertificate = {\n              subject: peerCert.subject && {\n                country: peerCert.subject.C,\n                stateOrProvince: peerCert.subject.ST,\n                locality: peerCert.subject.L,\n                organization: peerCert.subject.O,\n                organizationalUnit: peerCert.subject.OU,\n                commonName: peerCert.subject.CN,\n                alternativeNames: peerCert.subjectaltname\n              },\n              issuer: peerCert.issuer && {\n                country: peerCert.issuer.C,\n                stateOrProvince: peerCert.issuer.ST,\n                locality: peerCert.issuer.L,\n                organization: peerCert.issuer.O,\n                organizationalUnit: peerCert.issuer.OU,\n                commonName: peerCert.issuer.CN\n              },\n              validFrom: peerCert.valid_from,\n              validTo: peerCert.valid_to,\n              fingerprint: peerCert.fingerprint,\n              serialNumber: peerCert.serialNumber\n            };\n          }\n        };\n        socket.once('lookup', onLookupTiming);\n        socket.once('connect', onConnectTiming);\n        socket.once('secureConnect', onSecureConnectTiming);\n\n        // clean up timing event listeners if needed on error\n        self.req.once('error', function () {\n          socket.removeListener('lookup', onLookupTiming);\n          socket.removeListener('connect', onConnectTiming);\n        });\n      }\n    }\n    var setReqTimeout = function () {\n      // This timeout sets the amount of time to wait *between* bytes sent\n      // from the server once connected.\n      //\n      // In particular, it's useful for erroring if the server fails to send\n      // data halfway through streaming a response.\n      self.req.setTimeout(timeout, function () {\n        if (self.req) {\n          self.abort();\n          var e = new Error('ESOCKETTIMEDOUT');\n          e.code = 'ESOCKETTIMEDOUT';\n          e.connect = false;\n          self.emit('error', e);\n        }\n      });\n    };\n    if (timeout !== undefined) {\n      // Only start the connection timer if we're actually connecting a new\n      // socket, otherwise if we're already connected (because this is a\n      // keep-alive connection) do not bother. This is important since we won't\n      // get a 'connect' event for an already connected socket.\n      if (isConnecting) {\n        var onReqSockConnect = function () {\n          socket.removeListener('connect', onReqSockConnect);\n          self.clearTimeout();\n          setReqTimeout();\n        };\n        socket.on('connect', onReqSockConnect);\n        self.req.on('error', function (err) {\n          // eslint-disable-line handle-callback-err\n          socket.removeListener('connect', onReqSockConnect);\n        });\n\n        // Set a timeout in memory - this block will throw if the server takes more\n        // than `timeout` to write the HTTP status and headers (corresponding to\n        // the on('response') event on the client). NB: this measures wall-clock\n        // time, not the time between bytes sent by the server.\n        self.timeoutTimer = setTimeout(function () {\n          socket.removeListener('connect', onReqSockConnect);\n          self.abort();\n          var e = new Error('ETIMEDOUT');\n          e.code = 'ETIMEDOUT';\n          e.connect = true;\n          self.emit('error', e);\n        }, timeout);\n      } else {\n        // We're already connected\n        setReqTimeout();\n      }\n    }\n    self.emit('socket', socket);\n  });\n  self.emit('request', self.req);\n};\nRequest.prototype.onRequestError = function (error) {\n  var self = this;\n  if (self._aborted) {\n    return;\n  }\n  if (self.req && self.req._reusedSocket && error.code === 'ECONNRESET' && self.agent.addRequestNoreuse) {\n    self.agent = {\n      addRequest: self.agent.addRequestNoreuse.bind(self.agent)\n    };\n    self.start();\n    self.req.end();\n    return;\n  }\n  self.clearTimeout();\n  self.emit('error', error);\n};\nRequest.prototype.onRequestResponse = function (response) {\n  var self = this;\n  if (self.timing) {\n    self.timings.response = now() - self.startTimeNow;\n  }\n  debug('onRequestResponse', self.uri.href, response.statusCode, response.headers);\n  response.on('end', function () {\n    if (self.timing) {\n      self.timings.end = now() - self.startTimeNow;\n      response.timingStart = self.startTime;\n      response.timingStartTimer = self.startTimeNow;\n\n      // fill in the blanks for any periods that didn't trigger, such as\n      // no lookup or connect due to keep alive\n      if (!self.timings.socket) {\n        self.timings.socket = 0;\n      }\n      if (!self.timings.lookup) {\n        self.timings.lookup = self.timings.socket;\n      }\n      if (!self.timings.connect) {\n        self.timings.connect = self.timings.lookup;\n      }\n      if (!self.timings.secureConnect && self.httpModule === https) {\n        self.timings.secureConnect = self.timings.connect;\n      }\n      if (!self.timings.response) {\n        self.timings.response = self.timings.connect;\n      }\n      debug('elapsed time', self.timings.end);\n\n      // elapsedTime includes all redirects\n      self.elapsedTime += Math.round(self.timings.end);\n\n      // NOTE: elapsedTime is deprecated in favor of .timings\n      response.elapsedTime = self.elapsedTime;\n\n      // timings is just for the final fetch\n      response.timings = self.timings;\n\n      // pre-calculate phase timings as well\n      response.timingPhases = {\n        wait: self.timings.socket,\n        dns: self.timings.lookup - self.timings.socket,\n        tcp: self.timings.connect - self.timings.lookup,\n        firstByte: self.timings.response - self.timings.connect,\n        download: self.timings.end - self.timings.response,\n        total: self.timings.end\n      };\n\n      // if secureConnect is present, add secureHandshake and update firstByte\n      if (self.timings.secureConnect) {\n        response.timingPhases.secureHandshake = self.timings.secureConnect - self.timings.connect;\n        response.timingPhases.firstByte = self.timings.response - self.timings.secureConnect;\n      }\n    }\n    debug('response end', self.uri.href, response.statusCode, response.headers);\n  });\n  if (self._aborted) {\n    debug('aborted', self.uri.href);\n    response.resume();\n    return;\n  }\n  self._reqResInfo.response = {\n    statusCode: response.statusCode,\n    headers: parseResponseHeaders(response.rawHeaders),\n    httpVersion: response.httpVersion\n  };\n  if (self.timing) {\n    self._reqResInfo.timingStart = self.startTime;\n    self._reqResInfo.timingStartTimer = self.startTimeNow;\n    self._reqResInfo.timings = self.timings;\n  }\n  self.response = response;\n  response.request = self;\n  response.toJSON = responseToJSON;\n\n  // XXX This is different on 0.10, because SSL is strict by default\n  if (self.httpModule === https && self.strictSSL && (!response.hasOwnProperty('socket') || !response.socket.authorized)) {\n    debug('strict ssl error', self.uri.href);\n    var sslErr = response.hasOwnProperty('socket') ? response.socket.authorizationError : self.uri.href + ' does not support SSL';\n    self.emit('error', new Error('SSL Error: ' + sslErr));\n    return;\n  }\n\n  // Save the original host before any redirect (if it changes, we need to\n  // remove any authorization headers).  Also remember the case of the header\n  // name because lots of broken servers expect Host instead of host and we\n  // want the caller to be able to specify this.\n  self.originalHost = self.getHeader('host');\n  if (!self.originalHostHeaderName) {\n    self.originalHostHeaderName = self.hasHeader('host');\n  }\n  if (self.setHost) {\n    self.removeHeader('host');\n  }\n  self.clearTimeout();\n  function responseHandler() {\n    if (self._redirect.onResponse(response)) {\n      return; // Ignore the rest of the response\n    }\n\n    // Be a good stream and emit end when the response is finished.\n    // Hack to emit end on close because of a core bug that never fires end\n    response.once('close', function () {\n      if (!self._ended) {\n        self.response.emit('end');\n      }\n    });\n    response.once('end', function () {\n      self._ended = true;\n    });\n    var noBody = function (code) {\n      return self.method === 'HEAD' ||\n      // Informational\n      code >= 100 && code < 200 ||\n      // No Content\n      code === 204 ||\n      // Not Modified\n      code === 304;\n    };\n    var responseContent;\n    if ((self.gzip || self.brotli) && !noBody(response.statusCode)) {\n      var contentEncoding = response.headers['content-encoding'] || 'identity';\n      contentEncoding = contentEncoding.trim().toLowerCase();\n\n      // Be more lenient with decoding compressed responses, since (very rarely)\n      // servers send slightly invalid gzip responses that are still accepted\n      // by common browsers.\n      // Always using Z_SYNC_FLUSH is what cURL does.\n      var zlibOptions = {\n        flush: zlib.Z_SYNC_FLUSH,\n        finishFlush: zlib.Z_SYNC_FLUSH\n      };\n      if (self.gzip && contentEncoding === 'gzip') {\n        responseContent = zlib.createGunzip(zlibOptions);\n        response.pipe(responseContent);\n      } else if (self.gzip && contentEncoding === 'deflate') {\n        responseContent = inflate.createInflate(zlibOptions);\n        response.pipe(responseContent);\n      } else if (self.brotli && contentEncoding === 'br') {\n        responseContent = brotli.createBrotliDecompress();\n        response.pipe(responseContent);\n      } else {\n        // Since previous versions didn't check for Content-Encoding header,\n        // ignore any invalid values to preserve backwards-compatibility\n        if (contentEncoding !== 'identity') {\n          debug('ignoring unrecognized Content-Encoding ' + contentEncoding);\n        }\n        responseContent = response;\n      }\n    } else {\n      responseContent = response;\n    }\n    if (self.encoding) {\n      if (self.dests.length !== 0) {\n        console.error('Ignoring encoding parameter as this stream is being piped to another stream which makes the encoding option invalid.');\n      } else {\n        responseContent.setEncoding(self.encoding);\n      }\n    }\n\n    // Node by default returns the status message with `latin1` character encoding,\n    // which results in characters lying outside the range of `U+0000 to U+00FF` getting truncated\n    // so that they can be mapped in the given range.\n    // Refer: https://nodejs.org/docs/latest-v12.x/api/buffer.html#buffer_buffers_and_character_encodings\n    //\n    // Exposing `statusMessageEncoding` option to make encoding type configurable.\n    // This would help in correctly representing status messages belonging to range outside of `latin1`\n    //\n    // @note: The Regex `[^\\w\\s-']` is tested to prevent unnecessary computation of creating a Buffer and\n    // then decoding it when the status message consists of common characters,\n    // specifically belonging to the following set: [a-z, A-Z, 0-9, -, _ ', whitespace]\n    // As in that case, no matter what the encoding type is used for decoding the buffer, the result would remain the same.\n    //\n    // @note: Providing a value in this option will result in force re-encoding of the status message\n    // which may not always be intended by the server - specifically in cases where\n    // server returns a status message which when encoded again with a different character encoding\n    // results in some other characters.\n    // For example: If the server intentionally responds with `ð\\x9F\\x98\\x8A` as status message\n    // but if the statusMessageEncoding option is set to `utf8`, then it would get converted to '😊'.\n    var statusMessage = String(responseContent.statusMessage);\n    if (self.statusMessageEncoding && /[^\\w\\s-']/.test(statusMessage)) {\n      responseContent.statusMessage = Buffer.from(statusMessage, 'latin1').toString(self.statusMessageEncoding);\n    }\n    if (self._paused) {\n      responseContent.pause();\n    }\n    self.responseContent = responseContent;\n    self.emit('response', response);\n    self.dests.forEach(function (dest) {\n      self.pipeDest(dest);\n    });\n    var responseThresholdEnabled = false;\n    var responseBytesLeft;\n    if (typeof self.maxResponseSize === 'number') {\n      responseThresholdEnabled = true;\n      responseBytesLeft = self.maxResponseSize;\n    }\n    responseContent.on('data', function (chunk) {\n      if (self.timing && !self.responseStarted) {\n        self.responseStartTime = new Date().getTime();\n\n        // NOTE: responseStartTime is deprecated in favor of .timings\n        response.responseStartTime = self.responseStartTime;\n      }\n      // if response threshold is set, update the response bytes left to hit\n      // threshold. If exceeds, abort the request.\n      if (responseThresholdEnabled) {\n        responseBytesLeft -= chunk.length;\n        if (responseBytesLeft < 0) {\n          self.emit('error', new Error('Maximum response size reached'));\n          self.destroy();\n          self.abort();\n          return;\n        }\n      }\n      self._destdata = true;\n      self.emit('data', chunk);\n    });\n    responseContent.once('end', function (chunk) {\n      self.emit('end', chunk);\n    });\n    responseContent.on('error', function (error) {\n      self.emit('error', error);\n    });\n    responseContent.on('close', function () {\n      self.emit('close');\n    });\n    if (self.callback) {\n      self.readResponseBody(response);\n    } else {\n      // if no callback\n      self.on('end', function () {\n        if (self._aborted) {\n          debug('aborted', self.uri.href);\n          return;\n        }\n        self.emit('complete', response);\n      });\n    }\n  }\n  function forEachAsync(items, fn, cb) {\n    !cb && (cb = function () {/* (ಠ_ಠ) */});\n    if (!(Array.isArray(items) && fn)) {\n      return cb();\n    }\n    var index = 0;\n    var totalItems = items.length;\n    function next(err) {\n      if (err || index >= totalItems) {\n        return cb(err);\n      }\n      try {\n        fn.call(items, items[index++], next);\n      } catch (error) {\n        return cb(error);\n      }\n    }\n    if (!totalItems) {\n      return cb();\n    }\n    next();\n  }\n  var targetCookieJar = self._jar && self._jar.setCookie ? self._jar : globalCookieJar;\n  var addCookie = function (cookie, cb) {\n    // set the cookie if it's domain in the URI's domain.\n    targetCookieJar.setCookie(cookie, self.uri, {\n      ignoreError: true\n    }, function () {\n      // swallow the error, don't fail the request because of cookie jar failure\n      cb();\n    });\n  };\n  response.caseless = caseless(response.headers);\n  if (response.caseless.has('set-cookie') && !self._disableCookies) {\n    var headerName = response.caseless.has('set-cookie');\n    if (Array.isArray(response.headers[headerName])) {\n      forEachAsync(response.headers[headerName], addCookie, function (err) {\n        if (err) {\n          return self.emit('error', err);\n        }\n        responseHandler();\n      });\n    } else {\n      addCookie(response.headers[headerName], responseHandler);\n    }\n  } else {\n    responseHandler();\n  }\n  debug('finish init function', self.uri.href);\n};\nRequest.prototype.readResponseBody = function (response) {\n  var self = this;\n  debug('reading response\\'s body');\n  var buffers = [];\n  var bufferLength = 0;\n  var strings = [];\n  self.on('data', function (chunk) {\n    if (!Buffer.isBuffer(chunk)) {\n      strings.push(chunk);\n    } else if (chunk.length) {\n      bufferLength += chunk.length;\n      buffers.push(chunk);\n    }\n  });\n  self.on('end', function () {\n    debug('end event', self.uri.href);\n    if (self._aborted) {\n      debug('aborted', self.uri.href);\n      // `buffer` is defined in the parent scope and used in a closure it exists for the life of the request.\n      // This can lead to leaky behavior if the user retains a reference to the request object.\n      buffers = [];\n      bufferLength = 0;\n      return;\n    }\n    if (bufferLength) {\n      debug('has body', self.uri.href, bufferLength);\n      response.body = Buffer.concat(buffers, bufferLength);\n      if (self.encoding !== null) {\n        response.body = response.body.toString(self.encoding);\n      }\n      // `buffer` is defined in the parent scope and used in a closure it exists for the life of the Request.\n      // This can lead to leaky behavior if the user retains a reference to the request object.\n      buffers = [];\n      bufferLength = 0;\n    } else if (strings.length) {\n      // The UTF8 BOM [0xEF,0xBB,0xBF] is converted to [0xFE,0xFF] in the JS UTC16/UCS2 representation.\n      // Strip this value out when the encoding is set to 'utf8', as upstream consumers won't expect it and it breaks JSON.parse().\n      if (self.encoding === 'utf8' && strings[0].length > 0 && strings[0][0] === '\\uFEFF') {\n        strings[0] = strings[0].substring(1);\n      }\n      response.body = strings.join('');\n    }\n    if (self._json) {\n      try {\n        response.body = JSON.parse(response.body, self._jsonReviver);\n      } catch (e) {\n        debug('invalid JSON received', self.uri.href);\n      }\n    }\n    debug('emitting complete', self.uri.href);\n    if (typeof response.body === 'undefined' && !self._json) {\n      response.body = self.encoding === null ? Buffer.alloc(0) : '';\n    }\n    self.emit('complete', response, response.body);\n  });\n};\nRequest.prototype.abort = function () {\n  var self = this;\n  self._aborted = true;\n  if (self.req) {\n    self.req.abort();\n  } else if (self.response) {\n    self.response.destroy();\n  }\n  self.clearTimeout();\n  self.emit('abort');\n};\nRequest.prototype.pipeDest = function (dest) {\n  var self = this;\n  var response = self.response;\n  // Called after the response is received\n  if (dest.headers && !dest.headersSent) {\n    if (response.caseless.has('content-type')) {\n      var ctname = response.caseless.has('content-type');\n      if (dest.setHeader) {\n        dest.setHeader(ctname, response.headers[ctname]);\n      } else {\n        dest.headers[ctname] = response.headers[ctname];\n      }\n    }\n    if (response.caseless.has('content-length')) {\n      var clname = response.caseless.has('content-length');\n      if (dest.setHeader) {\n        dest.setHeader(clname, response.headers[clname]);\n      } else {\n        dest.headers[clname] = response.headers[clname];\n      }\n    }\n  }\n  if (dest.setHeader && !dest.headersSent) {\n    for (var i in response.headers) {\n      // If the response content is being decoded, the Content-Encoding header\n      // of the response doesn't represent the piped content, so don't pass it.\n      if (!self.gzip || i !== 'content-encoding') {\n        dest.setHeader(i, response.headers[i]);\n      }\n    }\n    dest.statusCode = response.statusCode;\n  }\n  if (self.pipefilter) {\n    self.pipefilter(response, dest);\n  }\n};\nRequest.prototype.qs = function (q, clobber) {\n  var self = this;\n  var base;\n  if (!clobber && self.uri.query) {\n    base = self._qs.parse(self.uri.query);\n  } else {\n    base = {};\n  }\n  for (var i in q) {\n    base[i] = q[i];\n  }\n  var qs = self._qs.stringify(base);\n  if (qs === '') {\n    return self;\n  }\n  self.uri = self.urlParser.parse(self.uri.href.split('?')[0] + '?' + qs);\n  self.url = self.uri;\n  self.path = self.uri.path;\n  if (self.uri.host === 'unix') {\n    self.enableUnixSocket();\n  }\n  return self;\n};\nRequest.prototype.form = function (form) {\n  var self = this;\n  var contentType = self.getHeader('content-type');\n  var overrideInvalidContentType = contentType ? !self.allowContentTypeOverride : true;\n  if (form) {\n    if (overrideInvalidContentType && !/^application\\/x-www-form-urlencoded\\b/.test(contentType)) {\n      self.setHeader('Content-Type', 'application/x-www-form-urlencoded');\n    }\n    self.body = typeof form === 'string' ? self._qs.rfc3986(form.toString('utf8')) : self._qs.stringify(form).toString('utf8');\n    return self;\n  }\n  // form-data\n  var contentTypeMatch = contentType && contentType.match && contentType.match(/^multipart\\/form-data;.*boundary=(?:\"([^\"]+)\"|([^;]+))/);\n  var boundary = contentTypeMatch && (contentTypeMatch[1] || contentTypeMatch[2]);\n  // create form-data object\n  // set custom boundary if present in content-type else auto-generate\n  self._form = new FormData({\n    _boundary: boundary\n  });\n  self._form.on('error', function (err) {\n    err.message = 'form-data: ' + err.message;\n    self.emit('error', err);\n    self.abort();\n  });\n  if (overrideInvalidContentType && !contentTypeMatch) {\n    // overrides invalid or missing content-type\n    self.setHeader('Content-Type', 'multipart/form-data; boundary=' + self._form.getBoundary());\n  }\n  return self._form;\n};\nRequest.prototype.multipart = function (multipart) {\n  var self = this;\n  self._multipart.onRequest(multipart);\n  if (!self._multipart.chunked) {\n    self.body = self._multipart.body;\n  }\n  return self;\n};\nRequest.prototype.json = function (val) {\n  var self = this;\n  if (!self.hasHeader('accept')) {\n    self.setHeader('Accept', 'application/json');\n  }\n  if (typeof self.jsonReplacer === 'function') {\n    self._jsonReplacer = self.jsonReplacer;\n  }\n  self._json = true;\n  if (typeof val === 'boolean') {\n    if (self.body !== undefined) {\n      if (!/^application\\/x-www-form-urlencoded\\b/.test(self.getHeader('content-type'))) {\n        self.body = safeStringify(self.body, self._jsonReplacer);\n      } else {\n        self.body = self._qs.rfc3986(self.body);\n      }\n      if (!self.hasHeader('content-type')) {\n        self.setHeader('Content-Type', 'application/json');\n      }\n    }\n  } else {\n    self.body = safeStringify(val, self._jsonReplacer);\n    if (!self.hasHeader('content-type')) {\n      self.setHeader('Content-Type', 'application/json');\n    }\n  }\n  if (typeof self.jsonReviver === 'function') {\n    self._jsonReviver = self.jsonReviver;\n  }\n  return self;\n};\nRequest.prototype.getHeader = function (name, headers) {\n  var self = this;\n  var result, re, match;\n  if (!headers) {\n    headers = self.headers;\n  }\n  Object.keys(headers).forEach(function (key) {\n    if (key.length !== name.length) {\n      return;\n    }\n    re = new RegExp(name, 'i');\n    match = key.match(re);\n    if (match) {\n      result = headers[key];\n    }\n  });\n  return result;\n};\nRequest.prototype.enableUnixSocket = function () {\n  // Get the socket & request paths from the URL\n  var unixParts = this.uri.path.split(':');\n  var host = unixParts[0];\n  var path = unixParts[1];\n  // Apply unix properties to request\n  this.socketPath = host;\n  this.uri.pathname = path;\n  this.uri.path = path;\n  this.uri.host = host;\n  this.uri.hostname = host;\n  this.uri.isUnix = true;\n};\nRequest.prototype.auth = function (user, pass, sendImmediately, bearer) {\n  var self = this;\n  self._auth.onRequest(user, pass, sendImmediately, bearer);\n  return self;\n};\nRequest.prototype.aws = function (opts, now) {\n  var self = this;\n  if (!now) {\n    self._aws = opts;\n    return self;\n  }\n  if (opts.sign_version === 4 || opts.sign_version === '4') {\n    // use aws4\n    var options = {\n      host: self.uri.host,\n      path: self.uri.path,\n      method: self.method,\n      headers: self.headers,\n      body: self.body\n    };\n    if (opts.service) {\n      options.service = opts.service;\n    }\n    var signRes = aws4.sign(options, {\n      accessKeyId: opts.key,\n      secretAccessKey: opts.secret,\n      sessionToken: opts.session\n    });\n    self.setHeader('Authorization', signRes.headers.Authorization);\n    self.setHeader('X-Amz-Date', signRes.headers['X-Amz-Date']);\n    if (signRes.headers['X-Amz-Security-Token']) {\n      self.setHeader('X-Amz-Security-Token', signRes.headers['X-Amz-Security-Token']);\n    }\n  } else {\n    // default: use aws-sign2\n    var date = new Date();\n    self.setHeader('Date', date.toUTCString());\n    var auth = {\n      key: opts.key,\n      secret: opts.secret,\n      verb: self.method.toUpperCase(),\n      date: date,\n      contentType: self.getHeader('content-type') || '',\n      md5: self.getHeader('content-md5') || '',\n      amazonHeaders: aws2.canonicalizeHeaders(self.headers)\n    };\n    var path = self.uri.path;\n    if (opts.bucket && path) {\n      auth.resource = '/' + opts.bucket + path;\n    } else if (opts.bucket && !path) {\n      auth.resource = '/' + opts.bucket;\n    } else if (!opts.bucket && path) {\n      auth.resource = path;\n    } else if (!opts.bucket && !path) {\n      auth.resource = '/';\n    }\n    auth.resource = aws2.canonicalizeResource(auth.resource);\n    self.setHeader('Authorization', aws2.authorization(auth));\n  }\n  return self;\n};\nRequest.prototype.httpSignature = function (opts) {\n  var self = this;\n  httpSignature.signRequest({\n    getHeader: function (header) {\n      return self.getHeader(header, self.headers);\n    },\n    setHeader: function (header, value) {\n      self.setHeader(header, value);\n    },\n    method: self.method,\n    path: self.path\n  }, opts);\n  debug('httpSignature authorization', self.getHeader('authorization'));\n  return self;\n};\nRequest.prototype.hawk = function (opts) {\n  var self = this;\n  self.setHeader('Authorization', hawk.header(self.uri, self.method, opts));\n};\nRequest.prototype.oauth = function (_oauth) {\n  var self = this;\n  self._oauth.onRequest(_oauth);\n  return self;\n};\nRequest.prototype.jar = function (jar, cb) {\n  var self = this;\n  self._jar = jar;\n  if (!jar) {\n    // disable cookies\n    self._disableCookies = true;\n    return cb();\n  }\n  if (self._redirect.redirectsFollowed === 0) {\n    self.originalCookieHeader = self.getHeader('cookie');\n  }\n  var targetCookieJar = jar.getCookieString ? jar : globalCookieJar;\n  // fetch cookie in the Specified host\n  targetCookieJar.getCookieString(self.uri, function (err, cookies) {\n    if (err) {\n      return cb();\n    }\n\n    // if need cookie and cookie is not empty\n    if (cookies && cookies.length) {\n      if (self.originalCookieHeader) {\n        if (Array.isArray(self.originalCookieHeader)) {\n          self.originalCookieHeader = self.originalCookieHeader.join('; ');\n        }\n        // Don't overwrite existing Cookie header\n        self.setHeader('Cookie', self.originalCookieHeader + '; ' + cookies);\n      } else {\n        self.setHeader('Cookie', cookies);\n      }\n    }\n    cb();\n  });\n};\n\n// Stream API\nRequest.prototype.pipe = function (dest, opts) {\n  var self = this;\n  if (self.response) {\n    if (self._destdata) {\n      self.emit('error', new Error('You cannot pipe after data has been emitted from the response.'));\n    } else if (self._ended) {\n      self.emit('error', new Error('You cannot pipe after the response has been ended.'));\n    } else {\n      stream.Stream.prototype.pipe.call(self, dest, opts);\n      self.pipeDest(dest);\n      return dest;\n    }\n  } else {\n    self.dests.push(dest);\n    stream.Stream.prototype.pipe.call(self, dest, opts);\n    return dest;\n  }\n};\nRequest.prototype.write = function () {\n  var self = this;\n  if (self._aborted) {\n    return;\n  }\n  if (!self._started) {\n    self.start();\n  }\n  if (self.req) {\n    return self.req.write.apply(self.req, arguments);\n  }\n};\nRequest.prototype.end = function (chunk) {\n  var self = this;\n  if (self._aborted) {\n    return;\n  }\n  if (chunk) {\n    self.write(chunk);\n  }\n  if (!self._started) {\n    self.start();\n  }\n  if (self.req) {\n    self.req.end();\n    self.req._header && (self._reqResInfo.request.headers = parseRequestHeaders(self.req._header));\n  }\n};\nRequest.prototype.pause = function () {\n  var self = this;\n  if (!self.responseContent) {\n    self._paused = true;\n  } else {\n    self.responseContent.pause.apply(self.responseContent, arguments);\n  }\n};\nRequest.prototype.resume = function () {\n  var self = this;\n  if (!self.responseContent) {\n    self._paused = false;\n  } else {\n    self.responseContent.resume.apply(self.responseContent, arguments);\n  }\n};\nRequest.prototype.destroy = function () {\n  var self = this;\n  this.clearTimeout();\n  if (!self._ended) {\n    self.end();\n  } else if (self.response) {\n    self.response.destroy();\n  }\n};\nRequest.prototype.clearTimeout = function () {\n  if (this.timeoutTimer) {\n    clearTimeout(this.timeoutTimer);\n    this.timeoutTimer = null;\n  }\n};\nRequest.defaultProxyHeaderWhiteList = Tunnel.defaultProxyHeaderWhiteList.slice();\nRequest.defaultProxyHeaderExclusiveList = Tunnel.defaultProxyHeaderExclusiveList.slice();\n\n// Exports\n\nRequest.prototype.toJSON = requestToJSON;\nmodule.exports = Request;","map":{"version":3,"names":["tls","require","http","https","url","util","stream","zlib","aws2","aws4","uuid","httpSignature","mime","caseless","ForeverAgent","FormData","extend","isstream","streamLength","isTypedArray","strict","helpers","cookies","getProxyFromURI","Querystring","Har","Auth","OAuth","hawk","Multipart","Redirect","Tunnel","now","Buffer","inflate","brotli","urlParse","safeStringify","isReadStream","toBase64","defer","copy","version","globalCookieJar","jar","globalPool","filterForNonReserved","reserved","options","object","i","notReserved","indexOf","filterOutReservedFunctions","isReserved","isFunction","transformFormData","formData","transformedFormData","appendFormParam","key","param","push","value","hasOwnProperty","undefined","formKey","formValue","Array","isArray","j","length","requestToJSON","self","uri","method","headers","responseToJSON","statusCode","body","request","call","parseRequestHeaders","headerString","arr","split","acc","splitIndex","slice","parseResponseHeaders","rawHeaders","Request","har","_har","urlParser","parse","resolve","Stream","Object","keys","prototype","nonReserved","readable","writable","_debug","explicitMethod","_qs","_auth","_oauth","_multipart","_redirect","_tunnel","init","inherits","debug","process","env","NODE_DEBUG","test","console","error","format","apply","arguments","_reqResInfo","bindOn","forEach","eventName","listener","on","once","bindOnce","headerName","httpify","localAddress","pool","dests","__isRequestRequest","_callback","callback","response","_callbackCalled","bind","baseUrl","emit","Error","baseUrlEndsWithSlash","lastIndexOf","uriStartsWithSlash","href","protocol","host","enableUnixSocket","strictSSL","rejectUnauthorized","pathname","hostname","port","isUnix","faultyUri","message","abort","proxy","auth","unescape","tunnel","isEnabled","setup","onRequest","setHost","Boolean","hasHeader","hostHeaderName","originalHostHeaderName","setHeader","form","requestForm","ii","formParam","append","qs","path","search","aws","user","username","pass","password","sendImmediately","bearer","acceptEncoding","gzip","uriAuthPieces","map","item","join","json","multipart","time","verbose","timing","elapsedTime","maxResponseSize","setContentLength","from","byteLength","reduce","a","b","oauth","params","defaultModules","httpModules","httpModule","ca","agents","agent","agentClass","agentOptions","forever","v","major","minor","SSL","Agent","keepAlive","getNewAgent","src","ntick","_started","lookup","_json","_aborted","end","_form","hasAuth","sentAuth","pipe","err","chunked","len","part","write","requestBodyStream","warn","_jar","getLength","isNaN","extraCA","ciphers","secureProtocol","secureOptions","cert","pfx","passphrase","poolKey","name","isHttps","__createSecureContext","toString","globalAgent","maxSockets","start","startTime","Date","getTime","startTimeNow","stat","size","_aws","httpVersion","reqOptions","disableUrlEncoding","e","timeout","req","blacklistHeaders","header","removeHeader","timings","timeoutTimer","isFinite","onRequestResponse","onRequestError","socket","reusedSocket","__SESSION_ID","__SESSION_DATA","session","id","reused","data","isConnecting","_connecting","connecting","onLookupTiming","onConnectTiming","connect","addresses","local","address","remote","remoteAddress","family","remoteFamily","remotePort","onSecureConnectTiming","secureConnect","isSessionReused","authorized","authorizationError","cipher","getCipher","getProtocol","ephemeralKeyInfo","getEphemeralKeyInfo","peerCert","getPeerCertificate","peerCertificate","subject","country","C","stateOrProvince","ST","locality","L","organization","O","organizationalUnit","OU","commonName","CN","alternativeNames","subjectaltname","issuer","validFrom","valid_from","validTo","valid_to","fingerprint","serialNumber","removeListener","setReqTimeout","setTimeout","code","onReqSockConnect","clearTimeout","_reusedSocket","addRequestNoreuse","addRequest","timingStart","timingStartTimer","Math","round","timingPhases","wait","dns","tcp","firstByte","download","total","secureHandshake","resume","toJSON","sslErr","originalHost","getHeader","responseHandler","onResponse","_ended","noBody","responseContent","contentEncoding","trim","toLowerCase","zlibOptions","flush","Z_SYNC_FLUSH","finishFlush","createGunzip","createInflate","createBrotliDecompress","encoding","setEncoding","statusMessage","String","statusMessageEncoding","_paused","pause","dest","pipeDest","responseThresholdEnabled","responseBytesLeft","chunk","responseStarted","responseStartTime","destroy","_destdata","readResponseBody","forEachAsync","items","fn","cb","index","totalItems","next","targetCookieJar","setCookie","addCookie","cookie","ignoreError","has","_disableCookies","buffers","bufferLength","strings","isBuffer","concat","substring","JSON","_jsonReviver","alloc","headersSent","ctname","clname","pipefilter","q","clobber","base","query","stringify","contentType","overrideInvalidContentType","allowContentTypeOverride","rfc3986","contentTypeMatch","match","boundary","_boundary","getBoundary","val","jsonReplacer","_jsonReplacer","jsonReviver","result","re","RegExp","unixParts","socketPath","opts","sign_version","service","signRes","sign","accessKeyId","secretAccessKey","secret","sessionToken","Authorization","date","toUTCString","verb","toUpperCase","md5","amazonHeaders","canonicalizeHeaders","bucket","resource","canonicalizeResource","authorization","signRequest","redirectsFollowed","originalCookieHeader","getCookieString","_header","defaultProxyHeaderWhiteList","defaultProxyHeaderExclusiveList","module","exports"],"sources":["/Users/Qusai.Qishta/node_modules/postman-request/request.js"],"sourcesContent":["'use strict'\n\nvar tls = require('tls')\nvar http = require('http')\nvar https = require('https')\nvar url = require('url')\nvar util = require('util')\nvar stream = require('stream')\nvar zlib = require('zlib')\nvar aws2 = require('aws-sign2')\nvar aws4 = require('aws4')\nvar uuid = require('uuid/v4')\nvar httpSignature = require('http-signature')\nvar mime = require('mime-types')\nvar caseless = require('caseless')\nvar ForeverAgent = require('forever-agent')\nvar FormData = require('@postman/form-data')\nvar extend = require('extend')\nvar isstream = require('isstream')\nvar streamLength = require('stream-length')\nvar isTypedArray = require('is-typedarray').strict\nvar helpers = require('./lib/helpers')\nvar cookies = require('./lib/cookies')\nvar getProxyFromURI = require('./lib/getProxyFromURI')\nvar Querystring = require('./lib/querystring').Querystring\nvar Har = require('./lib/har').Har\nvar Auth = require('./lib/auth').Auth\nvar OAuth = require('./lib/oauth').OAuth\nvar hawk = require('./lib/hawk')\nvar Multipart = require('./lib/multipart').Multipart\nvar Redirect = require('./lib/redirect').Redirect\nvar Tunnel = require('./lib/tunnel').Tunnel\nvar now = require('performance-now')\nvar Buffer = require('safe-buffer').Buffer\nvar inflate = require('./lib/inflate')\nvar brotli = require('./lib/brotli')\nvar urlParse = require('./lib/url-parse')\nvar safeStringify = helpers.safeStringify\nvar isReadStream = helpers.isReadStream\nvar toBase64 = helpers.toBase64\nvar defer = helpers.defer\nvar copy = helpers.copy\nvar version = helpers.version\nvar globalCookieJar = cookies.jar()\n\nvar globalPool = {}\n\nfunction filterForNonReserved (reserved, options) {\n  // Filter out properties that are not reserved.\n  // Reserved values are passed in at call site.\n\n  var object = {}\n  for (var i in options) {\n    var notReserved = (reserved.indexOf(i) === -1)\n    if (notReserved) {\n      object[i] = options[i]\n    }\n  }\n  return object\n}\n\nfunction filterOutReservedFunctions (reserved, options) {\n  // Filter out properties that are functions and are reserved.\n  // Reserved values are passed in at call site.\n\n  var object = {}\n  for (var i in options) {\n    var isReserved = !(reserved.indexOf(i) === -1)\n    var isFunction = (typeof options[i] === 'function')\n    if (!(isReserved && isFunction)) {\n      object[i] = options[i]\n    }\n  }\n  return object\n}\n\nfunction transformFormData (formData) {\n  // Transform the object representation of form-data fields to array representation.\n  // This might not preserve the order of form fields defined in object representation.\n  // But, this transformation is required to support backward compatibility.\n  //\n  // Form-Data should be stored as an array to respect the fields order.\n  // RFC 7578#section-5.2  Ordered Fields and Duplicated Field Names\n  // https://tools.ietf.org/html/rfc7578#section-5.2\n\n  var transformedFormData = []\n  var appendFormParam = function (key, param) {\n    transformedFormData.push({\n      key: key,\n      value: param && param.hasOwnProperty('value') ? param.value : param,\n      options: param && param.hasOwnProperty('options') ? param.options : undefined\n    })\n  }\n  for (var formKey in formData) {\n    if (formData.hasOwnProperty(formKey)) {\n      var formValue = formData[formKey]\n      if (Array.isArray(formValue)) {\n        for (var j = 0; j < formValue.length; j++) {\n          appendFormParam(formKey, formValue[j])\n        }\n      } else {\n        appendFormParam(formKey, formValue)\n      }\n    }\n  }\n  return transformedFormData\n}\n\n// Return a simpler request object to allow serialization\nfunction requestToJSON () {\n  var self = this\n  return {\n    uri: self.uri,\n    method: self.method,\n    headers: self.headers\n  }\n}\n\n// Return a simpler response object to allow serialization\nfunction responseToJSON () {\n  var self = this\n  return {\n    statusCode: self.statusCode,\n    body: self.body,\n    headers: self.headers,\n    request: requestToJSON.call(self.request)\n  }\n}\n\n/**\n * Return request headers in [{key: headerName, value: headerValue}] form\n * @param {String} [headerString] - headers string created by Node stored in ClientRequest._header\n *\n * */\nfunction parseRequestHeaders (headerString) {\n  var arr = headerString.split('\\r\\n')\n  var acc = []\n\n  // first element of accumulator is not a header\n  // last two elements are empty strings\n  for (var i = 1; i < arr.length - 2; i++) {\n    // header name cannot have a ':' but header value allows it\n    // therefore we split on the index of the first ':'\n    var splitIndex = arr[i].indexOf(':')\n\n    acc.push({\n      key: arr[i].slice(0, splitIndex),\n      value: arr[i].slice(splitIndex + 2)\n    })\n  }\n\n  return acc\n}\n\n/**\n * Return response headers in [{key: headerName, value: headerValue}] form\n * @param {Array} [rawHeaders] - https://nodejs.org/api/http.html#http_message_rawheaders\n *\n * */\nfunction parseResponseHeaders (rawHeaders) {\n  var acc = []\n\n  for (var i = 0; i < rawHeaders.length; i = i + 2) {\n    acc.push({\n      key: rawHeaders[i],\n      value: rawHeaders[i + 1]\n    })\n  }\n\n  return acc\n}\n\nfunction Request (options) {\n  // if given the method property in options, set property explicitMethod to true\n\n  // extend the Request instance with any non-reserved properties\n  // remove any reserved functions from the options object\n  // set Request instance to be readable and writable\n  // call init\n\n  var self = this\n\n  // start with HAR, then override with additional options\n  if (options.har) {\n    self._har = new Har(self)\n    options = self._har.options(options)\n  }\n\n  // transform `formData` for backward compatibility\n  // don't check for explicit object type to support legacy shenanigans\n  if (options.formData && !Array.isArray(options.formData)) {\n    options.formData = transformFormData(options.formData)\n  }\n\n  // use custom URL parser if provided, fallback to url.parse and url.resolve\n  if (!(\n    options.urlParser &&\n    typeof options.urlParser.parse === 'function' &&\n    typeof options.urlParser.resolve === 'function'\n  )) {\n    options.urlParser = {\n      parse: url.parse,\n      resolve: url.resolve\n    }\n  }\n\n  stream.Stream.call(self)\n  var reserved = Object.keys(Request.prototype)\n  var nonReserved = filterForNonReserved(reserved, options)\n\n  extend(self, nonReserved)\n  options = filterOutReservedFunctions(reserved, options)\n\n  self.readable = true\n  self.writable = true\n  self._debug = []\n  if (options.method) {\n    self.explicitMethod = true\n  }\n  self._qs = new Querystring(self)\n  self._auth = new Auth(self)\n  self._oauth = new OAuth(self)\n  self._multipart = new Multipart(self)\n  self._redirect = new Redirect(self)\n  self._tunnel = new Tunnel(self)\n  self.init(options)\n}\n\nutil.inherits(Request, stream.Stream)\n\n// Debugging\nRequest.debug = process.env.NODE_DEBUG && /\\brequest\\b/.test(process.env.NODE_DEBUG)\n\nfunction debug () {\n  if (Request.debug) {\n    console.error('REQUEST %s', util.format.apply(util, arguments))\n  }\n}\n\nRequest.prototype.debug = debug\n\nRequest.prototype.init = function (options) {\n  // init() contains all the code to setup the request object.\n  // the actual outgoing request is not started until start() is called\n  // this function is called from both the constructor and on redirect.\n  var self = this\n  if (!options) {\n    options = {}\n  }\n  self.headers = self.headers ? copy(self.headers) : {}\n\n  // for this request (or redirect) store its debug logs in `_reqResInfo` and\n  // store its reference in `_debug` which holds debug logs of every request\n  self._reqResInfo = {}\n  self._debug.push(self._reqResInfo)\n\n  // additional postman feature starts\n  // bind default events sent via options\n  if (options.bindOn) {\n    Object.keys(options.bindOn).forEach(function (eventName) {\n      !Array.isArray(options.bindOn[eventName]) && (options.bindOn[eventName] = [options.bindOn[eventName]])\n      options.bindOn[eventName].forEach(function (listener) {\n        self.on(eventName, listener)\n      })\n    })\n  }\n  if (options.once) {\n    Object.keys(options.once).forEach(function (eventName) {\n      !Array.isArray(options.bindOnce[eventName]) && (options.bindOnce[eventName] = [options.bindOnce[eventName]])\n      options.bindOnce[eventName].forEach(function (listener) {\n        self.once(eventName, listener)\n      })\n    })\n  }\n  // additional postman feature ends\n\n  // Delete headers with value undefined since they break\n  // ClientRequest.OutgoingMessage.setHeader in node 0.12\n  for (var headerName in self.headers) {\n    if (typeof self.headers[headerName] === 'undefined') {\n      delete self.headers[headerName]\n    }\n  }\n\n  caseless.httpify(self, self.headers)\n\n  if (!self.method) {\n    self.method = options.method || 'GET'\n  }\n  if (!self.localAddress) {\n    self.localAddress = options.localAddress\n  }\n\n  self._qs.init(options)\n\n  debug(options)\n  if (!self.pool && self.pool !== false) {\n    self.pool = globalPool\n  }\n  self.dests = self.dests || []\n  self.__isRequestRequest = true\n\n  // Protect against double callback\n  if (!self._callback && self.callback) {\n    self._callback = self.callback\n    self.callback = function (error, response, body) {\n      if (self._callbackCalled) {\n        return // Print a warning maybe?\n      }\n      self._callbackCalled = true\n      self._callback(error, response, body, self._debug)\n    }\n    self.on('error', self.callback.bind())\n    self.on('complete', self.callback.bind(self, null))\n  }\n\n  // People use this property instead all the time, so support it\n  if (!self.uri && self.url) {\n    self.uri = self.url\n    delete self.url\n  }\n\n  // If there's a baseUrl, then use it as the base URL (i.e. uri must be\n  // specified as a relative path and is appended to baseUrl).\n  if (self.baseUrl) {\n    if (typeof self.baseUrl !== 'string') {\n      return self.emit('error', new Error('options.baseUrl must be a string'))\n    }\n\n    if (typeof self.uri !== 'string') {\n      return self.emit('error', new Error('options.uri must be a string when using options.baseUrl'))\n    }\n\n    if (self.uri.indexOf('//') === 0 || self.uri.indexOf('://') !== -1) {\n      return self.emit('error', new Error('options.uri must be a path when using options.baseUrl'))\n    }\n\n    // Handle all cases to make sure that there's only one slash between\n    // baseUrl and uri.\n    var baseUrlEndsWithSlash = self.baseUrl.lastIndexOf('/') === self.baseUrl.length - 1\n    var uriStartsWithSlash = self.uri.indexOf('/') === 0\n\n    if (baseUrlEndsWithSlash && uriStartsWithSlash) {\n      self.uri = self.baseUrl + self.uri.slice(1)\n    } else if (baseUrlEndsWithSlash || uriStartsWithSlash) {\n      self.uri = self.baseUrl + self.uri\n    } else if (self.uri === '') {\n      self.uri = self.baseUrl\n    } else {\n      self.uri = self.baseUrl + '/' + self.uri\n    }\n    delete self.baseUrl\n  }\n\n  // A URI is needed by this point, emit error if we haven't been able to get one\n  if (!self.uri) {\n    return self.emit('error', new Error('options.uri is a required argument'))\n  }\n\n  // If a string URI/URL was given, parse it into a URL object\n  if (typeof self.uri === 'string') {\n    self.uri = self.urlParser.parse(self.uri)\n  }\n\n  // Some URL objects are not from a URL parsed string and need href added\n  if (!self.uri.href) {\n    self.uri.href = url.format(self.uri)\n  }\n\n  // DEPRECATED: Warning for users of the old Unix Sockets URL Scheme\n  if (self.uri.protocol === 'unix:') {\n    return self.emit('error', new Error('`unix://` URL scheme is no longer supported. Please use the format `http://unix:SOCKET:PATH`'))\n  }\n\n  // Support Unix Sockets\n  if (self.uri.host === 'unix') {\n    self.enableUnixSocket()\n  }\n\n  if (self.strictSSL === false) {\n    self.rejectUnauthorized = false\n  }\n\n  if (!self.uri.pathname) { self.uri.pathname = '/' }\n\n  if (!(self.uri.host || (self.uri.hostname && self.uri.port)) && !self.uri.isUnix) {\n    // Invalid URI: it may generate lot of bad errors, like 'TypeError: Cannot call method `indexOf` of undefined' in CookieJar\n    // Detect and reject it as soon as possible\n    var faultyUri = url.format(self.uri)\n    var message = 'Invalid URI \"' + faultyUri + '\"'\n    if (Object.keys(options).length === 0) {\n      // No option ? This can be the sign of a redirect\n      // As this is a case where the user cannot do anything (they didn't call request directly with this URL)\n      // they should be warned that it can be caused by a redirection (can save some hair)\n      message += '. This can be caused by a crappy redirection.'\n    }\n    // This error was fatal\n    self.abort()\n    return self.emit('error', new Error(message))\n  }\n\n  if (!self.hasOwnProperty('proxy')) {\n    self.proxy = getProxyFromURI(self.uri)\n  }\n\n  if (typeof self.proxy === 'string') {\n    self.proxy = self.urlParser.parse(self.proxy)\n\n    if (self.proxy.auth) {\n      self.proxy.auth = self._qs.unescape(self.proxy.auth)\n    }\n  }\n\n  self.tunnel = self._tunnel.isEnabled()\n  if (self.proxy) {\n    self._tunnel.setup(options)\n  }\n\n  self._redirect.onRequest(options)\n\n  // Add `Host` header if not defined already\n  self.setHost = (self.setHost === undefined || Boolean(self.setHost))\n  if (!self.hasHeader('host') && self.setHost) {\n    var hostHeaderName = self.originalHostHeaderName || 'Host'\n    self.setHeader(hostHeaderName, self.uri.host)\n    // Drop :port suffix from Host header if known protocol.\n    if (self.uri.port) {\n      if ((self.uri.port === '80' && self.uri.protocol === 'http:') ||\n          (self.uri.port === '443' && self.uri.protocol === 'https:')) {\n        self.setHeader(hostHeaderName, self.uri.hostname)\n      }\n    }\n  }\n\n  if (!self.uri.port) {\n    if (self.uri.protocol === 'http:') { self.uri.port = 80 } else if (self.uri.protocol === 'https:') { self.uri.port = 443 }\n  }\n\n  if (self.proxy && !self.tunnel) {\n    self.port = self.proxy.port\n    self.host = self.proxy.hostname\n  } else {\n    self.port = self.uri.port\n    self.host = self.uri.hostname\n  }\n\n  if (options.form) {\n    self.form(options.form)\n  }\n\n  if (options.formData) {\n    var formData = options.formData\n    var requestForm = self.form()\n    for (var i = 0, ii = formData.length; i < ii; i++) {\n      var formParam = formData[i]\n      if (!formParam) { continue }\n      if (formParam.options) {\n        requestForm.append(formParam.key, formParam.value, formParam.options)\n      } else {\n        requestForm.append(formParam.key, formParam.value)\n      }\n    }\n  }\n\n  if (options.qs) {\n    self.qs(options.qs)\n  }\n\n  if (self.uri.path) {\n    self.path = self.uri.path\n  } else {\n    self.path = self.uri.pathname + (self.uri.search || '')\n  }\n\n  if (self.path.length === 0) {\n    self.path = '/'\n  }\n\n  // Auth must happen last in case signing is dependent on other headers\n  if (options.aws) {\n    self.aws(options.aws)\n  }\n\n  if (options.hawk) {\n    self.hawk(options.hawk)\n  }\n\n  if (options.httpSignature) {\n    self.httpSignature(options.httpSignature)\n  }\n\n  if (options.auth) {\n    if (Object.prototype.hasOwnProperty.call(options.auth, 'username')) {\n      options.auth.user = options.auth.username\n    }\n    if (Object.prototype.hasOwnProperty.call(options.auth, 'password')) {\n      options.auth.pass = options.auth.password\n    }\n\n    self.auth(\n      options.auth.user,\n      options.auth.pass,\n      options.auth.sendImmediately,\n      options.auth.bearer\n    )\n  }\n\n  if (!self.hasHeader('accept-encoding')) {\n    var acceptEncoding = ''\n\n    self.gzip && (acceptEncoding += 'gzip, deflate')\n\n    if (self.brotli) {\n      acceptEncoding && (acceptEncoding += ', ')\n      acceptEncoding += 'br'\n    }\n\n    acceptEncoding && self.setHeader('Accept-Encoding', acceptEncoding)\n  }\n\n  if (self.uri.auth && !self.hasHeader('authorization')) {\n    var uriAuthPieces = self.uri.auth.split(':').map(function (item) { return self._qs.unescape(item) })\n    self.auth(uriAuthPieces[0], uriAuthPieces.slice(1).join(':'), true)\n  }\n\n  if (!self.tunnel && self.proxy && self.proxy.auth && !self.hasHeader('proxy-authorization')) {\n    self.setHeader('Proxy-Authorization', 'Basic ' + toBase64(self.proxy.auth))\n  }\n\n  if (self.proxy && !self.tunnel) {\n    self.path = (self.uri.protocol + '//' + self.uri.host + self.path)\n  }\n\n  if (options.json) {\n    self.json(options.json)\n  }\n  if (options.multipart) {\n    self.multipart(options.multipart)\n  }\n\n  // enable timings if verbose is true\n  if (options.time || options.verbose) {\n    self.timing = true\n\n    // NOTE: elapsedTime is deprecated in favor of .timings\n    self.elapsedTime = self.elapsedTime || 0\n  }\n\n  if (options.verbose) {\n    self.verbose = true\n  }\n\n  if (typeof options.maxResponseSize === 'number') {\n    self.maxResponseSize = options.maxResponseSize\n  }\n\n  function setContentLength () {\n    if (isTypedArray(self.body)) {\n      self.body = Buffer.from(self.body)\n    }\n\n    if (!self.hasHeader('content-length')) {\n      var length\n      if (typeof self.body === 'string') {\n        length = Buffer.byteLength(self.body)\n      } else if (Array.isArray(self.body)) {\n        length = self.body.reduce(function (a, b) { return a + b.length }, 0)\n      } else {\n        length = self.body.length\n      }\n\n      if (length) {\n        self.setHeader('Content-Length', length)\n      } else {\n        self.emit('error', new Error('Argument error, options.body.'))\n      }\n    }\n  }\n\n  if (self.body && !isstream(self.body)) {\n    setContentLength()\n  }\n\n  if (options.oauth) {\n    self.oauth(options.oauth)\n  } else if (self._oauth.params && self.hasHeader('authorization')) {\n    self.oauth(self._oauth.params)\n  }\n\n  var protocol = self.proxy && !self.tunnel ? self.proxy.protocol : self.uri.protocol\n  var defaultModules = {'http:': http, 'https:': https}\n  var httpModules = self.httpModules || {}\n\n  self.httpModule = httpModules[protocol] || defaultModules[protocol]\n\n  if (!self.httpModule) {\n    return self.emit('error', new Error('Invalid protocol: ' + protocol))\n  }\n\n  if (options.ca) {\n    self.ca = options.ca\n  }\n\n  // prefer common self.agent if exists\n  if (self.agents && !self.agent) {\n    var agent = protocol === 'http:' ? self.agents.http : self.agents.https\n    if (agent) {\n      if (agent.agentClass || agent.agentOptions) {\n        options.agentClass = agent.agentClass || options.agentClass\n        options.agentOptions = agent.agentOptions || options.agentOptions\n      } else {\n        self.agent = agent\n      }\n    }\n  }\n\n  if (!self.agent) {\n    if (options.agentOptions) {\n      self.agentOptions = options.agentOptions\n    }\n\n    if (options.agentClass) {\n      self.agentClass = options.agentClass\n    } else if (options.forever) {\n      var v = version()\n      // use ForeverAgent in node 0.10- only\n      if (v.major === 0 && v.minor <= 10) {\n        self.agentClass = protocol === 'http:' ? ForeverAgent : ForeverAgent.SSL\n      } else {\n        self.agentClass = self.httpModule.Agent\n        self.agentOptions = self.agentOptions || {}\n        self.agentOptions.keepAlive = true\n      }\n    } else {\n      self.agentClass = self.httpModule.Agent\n    }\n  }\n\n  if (self.pool === false) {\n    self.agent = false\n  } else {\n    self.agent = self.agent || self.getNewAgent()\n  }\n\n  self.on('pipe', function (src) {\n    if (self.ntick && self._started) {\n      self.emit('error', new Error('You cannot pipe to this stream after the outbound request has started.'))\n    }\n    self.src = src\n    if (isReadStream(src)) {\n      if (!self.hasHeader('content-type')) {\n        // @note fallback to 'application/octet-stream' if mime.lookup returns `false`\n        self.setHeader('Content-Type', mime.lookup(src.path) || 'application/octet-stream')\n      }\n    } else {\n      if (src.headers) {\n        for (var i in src.headers) {\n          if (!self.hasHeader(i)) {\n            self.setHeader(i, src.headers[i])\n          }\n        }\n      }\n      if (self._json && !self.hasHeader('content-type')) {\n        self.setHeader('Content-Type', 'application/json')\n      }\n      if (src.method && !self.explicitMethod) {\n        self.method = src.method\n      }\n    }\n\n    // self.on('pipe', function () {\n    //   console.error('You have already piped to this stream. Pipeing twice is likely to break the request.')\n    // })\n  })\n\n  defer(function () {\n    if (self._aborted) {\n      return\n    }\n\n    var end = function () {\n      if (self._form) {\n        if (!self._auth.hasAuth || (self._auth.hasAuth && self._auth.sentAuth)) {\n          try {\n            self._form.pipe(self)\n          } catch (err) {\n            self.abort()\n            options.callback && options.callback(err)\n            return\n          }\n        }\n      }\n      if (self._multipart && self._multipart.chunked) {\n        self._multipart.body.pipe(self)\n      }\n      if (self.body) {\n        if (isstream(self.body)) {\n          if (self.hasHeader('content-length')) {\n            self.body.pipe(self)\n          } else { // certain servers require content-length to function. we try to pre-detect if possible\n            streamLength(self.body, {}, function (err, len) {\n              if (!(err || self._started || self.hasHeader('content-length') || len === null || len < 0)) {\n                self.setHeader('Content-Length', len)\n              }\n              self.body.pipe(self)\n            })\n          }\n        } else {\n          setContentLength()\n          if (Array.isArray(self.body)) {\n            self.body.forEach(function (part) {\n              self.write(part)\n            })\n          } else {\n            self.write(self.body)\n          }\n          self.end()\n        }\n      } else if (self.requestBodyStream) {\n        console.warn('options.requestBodyStream is deprecated, please pass the request object to stream.pipe.')\n        self.requestBodyStream.pipe(self)\n      } else if (!self.src) {\n        if ((self._auth.hasAuth && !self._auth.sentAuth) || self.hasHeader('content-length')) {\n          self.end()\n          return\n        }\n        switch (self.method) {\n          case 'GET':\n          case 'HEAD':\n          case 'TRACE':\n          case 'DELETE':\n          case 'CONNECT':\n          case 'OPTIONS':\n          case undefined:\n            // @note this behavior is same as Node.js\n            break\n          default:\n            self.setHeader('Content-Length', 0)\n            break\n        }\n        self.end()\n      }\n    }\n\n    self.jar(self._jar || options.jar, function () {\n      if (self._form && !self.hasHeader('content-length')) {\n        // Before ending the request, we had to compute the length of the whole form, asyncly\n        self._form.getLength(function (err, length) {\n          if (!err && !isNaN(length)) {\n            self.setHeader('Content-Length', length)\n          }\n          end()\n        })\n      } else {\n        end()\n      }\n    })\n\n    self.ntick = true\n  })\n}\n\nRequest.prototype.getNewAgent = function () {\n  var self = this\n  var Agent = self.agentClass\n  var options = {}\n  if (self.agentOptions) {\n    for (var i in self.agentOptions) {\n      options[i] = self.agentOptions[i]\n    }\n  }\n  if (self.ca) {\n    options.ca = self.ca\n  }\n  if (self.extraCA) {\n    options.extraCA = self.extraCA\n  }\n  if (self.ciphers) {\n    options.ciphers = self.ciphers\n  }\n  if (self.secureProtocol) {\n    options.secureProtocol = self.secureProtocol\n  }\n  if (self.secureOptions) {\n    options.secureOptions = self.secureOptions\n  }\n  if (typeof self.rejectUnauthorized !== 'undefined') {\n    options.rejectUnauthorized = self.rejectUnauthorized\n  }\n\n  if (self.cert && self.key) {\n    options.key = self.key\n    options.cert = self.cert\n  }\n\n  if (self.pfx) {\n    options.pfx = self.pfx\n  }\n\n  if (self.passphrase) {\n    options.passphrase = self.passphrase\n  }\n\n  var poolKey = ''\n\n  // different types of agents are in different pools\n  if (Agent !== self.httpModule.Agent) {\n    poolKey += Agent.name\n  }\n\n  // ca option is only relevant if proxy or destination are https\n  var proxy = self.proxy\n  if (typeof proxy === 'string') {\n    proxy = self.urlParser.parse(proxy)\n  }\n  var isHttps = (proxy && proxy.protocol === 'https:') || this.uri.protocol === 'https:'\n\n  if (isHttps) {\n    if (options.ca) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.ca\n    }\n\n    // only add when NodeExtraCACerts is enabled\n    if (tls.__createSecureContext && options.extraCA) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.extraCA\n    }\n\n    if (typeof options.rejectUnauthorized !== 'undefined') {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.rejectUnauthorized\n    }\n\n    if (options.cert) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.cert.toString('ascii') + options.key.toString('ascii')\n    }\n\n    if (options.pfx) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.pfx.toString('ascii')\n    }\n\n    if (options.passphrase) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.passphrase\n    }\n\n    if (options.ciphers) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.ciphers\n    }\n\n    if (options.secureProtocol) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.secureProtocol\n    }\n\n    if (options.secureOptions) {\n      if (poolKey) {\n        poolKey += ':'\n      }\n      poolKey += options.secureOptions\n    }\n  }\n\n  if (self.pool === globalPool && !poolKey && Object.keys(options).length === 0 && self.httpModule.globalAgent) {\n    // not doing anything special.  Use the globalAgent\n    return self.httpModule.globalAgent\n  }\n\n  // we're using a stored agent.  Make sure it's protocol-specific\n  poolKey = self.uri.protocol + poolKey\n\n  // generate a new agent for this setting if none yet exists\n  if (!self.pool[poolKey]) {\n    self.pool[poolKey] = new Agent(options)\n    // properly set maxSockets on new agents\n    if (self.pool.maxSockets) {\n      self.pool[poolKey].maxSockets = self.pool.maxSockets\n    }\n  }\n\n  return self.pool[poolKey]\n}\n\nRequest.prototype.start = function () {\n  // start() is called once we are ready to send the outgoing HTTP request.\n  // this is usually called on the first write(), end() or on nextTick()\n  var self = this\n\n  if (self.timing) {\n    // All timings will be relative to this request's startTime.  In order to do this,\n    // we need to capture the wall-clock start time (via Date), immediately followed\n    // by the high-resolution timer (via now()).  While these two won't be set\n    // at the _exact_ same time, they should be close enough to be able to calculate\n    // high-resolution, monotonically non-decreasing timestamps relative to startTime.\n    var startTime = new Date().getTime()\n    var startTimeNow = now()\n  }\n\n  if (self._aborted) {\n    return\n  }\n\n  // postman: emit start event\n  self.emit('start')\n\n  self._started = true\n  self.method = self.method || 'GET'\n  self.href = self.uri.href\n\n  if (self.src && self.src.stat && self.src.stat.size && !self.hasHeader('content-length')) {\n    self.setHeader('Content-Length', self.src.stat.size)\n  }\n  if (self._aws) {\n    self.aws(self._aws, true)\n  }\n\n  self._reqResInfo.request = {\n    method: self.method,\n    href: self.uri.href,\n    headers: [],\n    proxy: (self.proxy && { href: self.proxy.href }) || undefined,\n    httpVersion: '1.1'\n  }\n\n  // We have a method named auth, which is completely different from the http.request\n  // auth option.  If we don't remove it, we're gonna have a bad time.\n  var reqOptions = copy(self)\n  delete reqOptions.auth\n\n  // Workaround for a bug in Node: https://github.com/nodejs/node/issues/8321\n  if (!(self.disableUrlEncoding || self.proxy || self.uri.isUnix)) {\n    try {\n      extend(reqOptions, urlParse(self.uri.href))\n    } catch (e) { } // nothing to do if urlParse fails, \"extend\" never throws an error.\n  }\n\n  debug('make request', self.uri.href)\n\n  // node v6.8.0 now supports a `timeout` value in `http.request()`, but we\n  // should delete it for now since we handle timeouts manually for better\n  // consistency with node versions before v6.8.0\n  delete reqOptions.timeout\n\n  try {\n    self.req = self.httpModule.request(reqOptions)\n\n    // Remove blacklisted headers from the request instance.\n    // @note don't check for `hasHeader` because headers like `connection`,\n    // 'content-length', 'transfer-encoding' etc. are added at the very end\n    // and `removeHeader` updates the Node.js internal state which makes sure\n    // these headers are not added.\n    if (Array.isArray(self.blacklistHeaders) && self.blacklistHeaders.length) {\n      self.blacklistHeaders.forEach(function (header) {\n        self.req.removeHeader(header)\n        // also remove from the `self` for the consistency\n        self.removeHeader(header)\n      })\n    }\n  } catch (err) {\n    self.emit('error', err)\n    return\n  }\n\n  if (self.timing) {\n    self.startTime = startTime\n    self.startTimeNow = startTimeNow\n\n    // Timing values will all be relative to startTime (by comparing to startTimeNow\n    // so we have an accurate clock)\n    self.timings = {}\n  }\n\n  var timeout\n  if (self.timeout && !self.timeoutTimer) {\n    if (self.timeout < 0) {\n      timeout = 0\n    } else if (typeof self.timeout === 'number' && isFinite(self.timeout)) {\n      timeout = self.timeout\n    }\n  }\n\n  self.req.on('response', self.onRequestResponse.bind(self))\n  self.req.on('error', self.onRequestError.bind(self))\n  self.req.on('drain', function () {\n    self.emit('drain')\n  })\n\n  self.req.on('socket', function (socket) {\n    if (self.verbose) {\n      // The reused socket holds all the session data which was injected in\n      // during the first connection. This is done because events like\n      // `lookup`, `connect` & `secureConnect` will not be triggered for a\n      // reused socket and debug information will be lost for that request.\n      var reusedSocket = Boolean(socket.__SESSION_ID && socket.__SESSION_DATA)\n\n      if (!reusedSocket) {\n        socket.__SESSION_ID = uuid()\n        socket.__SESSION_DATA = {}\n      }\n\n      // @note make sure you don't serialize this object to avoid memory leak\n      self._reqResInfo.session = {\n        id: socket.__SESSION_ID,\n        reused: reusedSocket,\n        data: socket.__SESSION_DATA\n      }\n    }\n\n    // `._connecting` was the old property which was made public in node v6.1.0\n    var isConnecting = socket._connecting || socket.connecting\n    if (self.timing) {\n      self.timings.socket = now() - self.startTimeNow\n\n      if (isConnecting) {\n        var onLookupTiming = function () {\n          self.timings.lookup = now() - self.startTimeNow\n        }\n\n        var onConnectTiming = function () {\n          self.timings.connect = now() - self.startTimeNow\n\n          if (self.verbose) {\n            socket.__SESSION_DATA.addresses = {\n              // local address\n              // @note there's no `socket.localFamily` but `.address` method\n              // returns same output as of remote.\n              local: (typeof socket.address === 'function') && socket.address(),\n\n              // remote address\n              remote: {\n                address: socket.remoteAddress,\n                family: socket.remoteFamily,\n                port: socket.remotePort\n              }\n            }\n          }\n        }\n\n        var onSecureConnectTiming = function () {\n          self.timings.secureConnect = now() - self.startTimeNow\n\n          if (self.verbose) {\n            socket.__SESSION_DATA.tls = {\n              // true if the session was reused\n              reused: (typeof socket.isSessionReused === 'function') && socket.isSessionReused(),\n\n              // true if the peer certificate was signed by one of the CAs specified\n              authorized: socket.authorized,\n\n              // reason why the peer's certificate was not been verified\n              authorizationError: socket.authorizationError,\n\n              // negotiated cipher name\n              cipher: (typeof socket.getCipher === 'function') && socket.getCipher(),\n\n              // negotiated SSL/TLS protocol version\n              // @note Node >= v5.7.0\n              protocol: (typeof socket.getProtocol === 'function') && socket.getProtocol(),\n\n              // type, name, and size of parameter of an ephemeral key exchange\n              // @note Node >= v5.0.0\n              ephemeralKeyInfo: (typeof socket.getEphemeralKeyInfo === 'function') && socket.getEphemeralKeyInfo()\n            }\n\n            // peer certificate information\n            // @note if session is reused, all certificate information is\n            // stripped from the socket (returns {}).\n            // Refer: https://github.com/nodejs/node/issues/3940\n            var peerCert = (typeof socket.getPeerCertificate === 'function') && (socket.getPeerCertificate() || {})\n\n            socket.__SESSION_DATA.tls.peerCertificate = {\n              subject: peerCert.subject && {\n                country: peerCert.subject.C,\n                stateOrProvince: peerCert.subject.ST,\n                locality: peerCert.subject.L,\n                organization: peerCert.subject.O,\n                organizationalUnit: peerCert.subject.OU,\n                commonName: peerCert.subject.CN,\n                alternativeNames: peerCert.subjectaltname\n              },\n              issuer: peerCert.issuer && {\n                country: peerCert.issuer.C,\n                stateOrProvince: peerCert.issuer.ST,\n                locality: peerCert.issuer.L,\n                organization: peerCert.issuer.O,\n                organizationalUnit: peerCert.issuer.OU,\n                commonName: peerCert.issuer.CN\n              },\n              validFrom: peerCert.valid_from,\n              validTo: peerCert.valid_to,\n              fingerprint: peerCert.fingerprint,\n              serialNumber: peerCert.serialNumber\n            }\n          }\n        }\n\n        socket.once('lookup', onLookupTiming)\n        socket.once('connect', onConnectTiming)\n        socket.once('secureConnect', onSecureConnectTiming)\n\n        // clean up timing event listeners if needed on error\n        self.req.once('error', function () {\n          socket.removeListener('lookup', onLookupTiming)\n          socket.removeListener('connect', onConnectTiming)\n        })\n      }\n    }\n\n    var setReqTimeout = function () {\n      // This timeout sets the amount of time to wait *between* bytes sent\n      // from the server once connected.\n      //\n      // In particular, it's useful for erroring if the server fails to send\n      // data halfway through streaming a response.\n      self.req.setTimeout(timeout, function () {\n        if (self.req) {\n          self.abort()\n          var e = new Error('ESOCKETTIMEDOUT')\n          e.code = 'ESOCKETTIMEDOUT'\n          e.connect = false\n          self.emit('error', e)\n        }\n      })\n    }\n    if (timeout !== undefined) {\n      // Only start the connection timer if we're actually connecting a new\n      // socket, otherwise if we're already connected (because this is a\n      // keep-alive connection) do not bother. This is important since we won't\n      // get a 'connect' event for an already connected socket.\n      if (isConnecting) {\n        var onReqSockConnect = function () {\n          socket.removeListener('connect', onReqSockConnect)\n          self.clearTimeout()\n          setReqTimeout()\n        }\n\n        socket.on('connect', onReqSockConnect)\n\n        self.req.on('error', function (err) { // eslint-disable-line handle-callback-err\n          socket.removeListener('connect', onReqSockConnect)\n        })\n\n        // Set a timeout in memory - this block will throw if the server takes more\n        // than `timeout` to write the HTTP status and headers (corresponding to\n        // the on('response') event on the client). NB: this measures wall-clock\n        // time, not the time between bytes sent by the server.\n        self.timeoutTimer = setTimeout(function () {\n          socket.removeListener('connect', onReqSockConnect)\n          self.abort()\n          var e = new Error('ETIMEDOUT')\n          e.code = 'ETIMEDOUT'\n          e.connect = true\n          self.emit('error', e)\n        }, timeout)\n      } else {\n        // We're already connected\n        setReqTimeout()\n      }\n    }\n    self.emit('socket', socket)\n  })\n\n  self.emit('request', self.req)\n}\n\nRequest.prototype.onRequestError = function (error) {\n  var self = this\n  if (self._aborted) {\n    return\n  }\n  if (self.req && self.req._reusedSocket && error.code === 'ECONNRESET' &&\n    self.agent.addRequestNoreuse) {\n    self.agent = {addRequest: self.agent.addRequestNoreuse.bind(self.agent)}\n    self.start()\n    self.req.end()\n    return\n  }\n  self.clearTimeout()\n  self.emit('error', error)\n}\n\nRequest.prototype.onRequestResponse = function (response) {\n  var self = this\n\n  if (self.timing) {\n    self.timings.response = now() - self.startTimeNow\n  }\n\n  debug('onRequestResponse', self.uri.href, response.statusCode, response.headers)\n  response.on('end', function () {\n    if (self.timing) {\n      self.timings.end = now() - self.startTimeNow\n      response.timingStart = self.startTime\n      response.timingStartTimer = self.startTimeNow\n\n      // fill in the blanks for any periods that didn't trigger, such as\n      // no lookup or connect due to keep alive\n      if (!self.timings.socket) {\n        self.timings.socket = 0\n      }\n      if (!self.timings.lookup) {\n        self.timings.lookup = self.timings.socket\n      }\n      if (!self.timings.connect) {\n        self.timings.connect = self.timings.lookup\n      }\n      if (!self.timings.secureConnect && self.httpModule === https) {\n        self.timings.secureConnect = self.timings.connect\n      }\n      if (!self.timings.response) {\n        self.timings.response = self.timings.connect\n      }\n\n      debug('elapsed time', self.timings.end)\n\n      // elapsedTime includes all redirects\n      self.elapsedTime += Math.round(self.timings.end)\n\n      // NOTE: elapsedTime is deprecated in favor of .timings\n      response.elapsedTime = self.elapsedTime\n\n      // timings is just for the final fetch\n      response.timings = self.timings\n\n      // pre-calculate phase timings as well\n      response.timingPhases = {\n        wait: self.timings.socket,\n        dns: self.timings.lookup - self.timings.socket,\n        tcp: self.timings.connect - self.timings.lookup,\n        firstByte: self.timings.response - self.timings.connect,\n        download: self.timings.end - self.timings.response,\n        total: self.timings.end\n      }\n\n      // if secureConnect is present, add secureHandshake and update firstByte\n      if (self.timings.secureConnect) {\n        response.timingPhases.secureHandshake = self.timings.secureConnect - self.timings.connect\n        response.timingPhases.firstByte = self.timings.response - self.timings.secureConnect\n      }\n    }\n\n    debug('response end', self.uri.href, response.statusCode, response.headers)\n  })\n\n  if (self._aborted) {\n    debug('aborted', self.uri.href)\n    response.resume()\n    return\n  }\n\n  self._reqResInfo.response = {\n    statusCode: response.statusCode,\n    headers: parseResponseHeaders(response.rawHeaders),\n    httpVersion: response.httpVersion\n  }\n\n  if (self.timing) {\n    self._reqResInfo.timingStart = self.startTime\n    self._reqResInfo.timingStartTimer = self.startTimeNow\n    self._reqResInfo.timings = self.timings\n  }\n\n  self.response = response\n  response.request = self\n  response.toJSON = responseToJSON\n\n  // XXX This is different on 0.10, because SSL is strict by default\n  if (self.httpModule === https &&\n    self.strictSSL && (!response.hasOwnProperty('socket') ||\n      !response.socket.authorized)) {\n    debug('strict ssl error', self.uri.href)\n    var sslErr = response.hasOwnProperty('socket') ? response.socket.authorizationError : self.uri.href + ' does not support SSL'\n    self.emit('error', new Error('SSL Error: ' + sslErr))\n    return\n  }\n\n  // Save the original host before any redirect (if it changes, we need to\n  // remove any authorization headers).  Also remember the case of the header\n  // name because lots of broken servers expect Host instead of host and we\n  // want the caller to be able to specify this.\n  self.originalHost = self.getHeader('host')\n  if (!self.originalHostHeaderName) {\n    self.originalHostHeaderName = self.hasHeader('host')\n  }\n  if (self.setHost) {\n    self.removeHeader('host')\n  }\n  self.clearTimeout()\n\n  function responseHandler () {\n    if (self._redirect.onResponse(response)) {\n      return // Ignore the rest of the response\n    }\n\n    // Be a good stream and emit end when the response is finished.\n    // Hack to emit end on close because of a core bug that never fires end\n    response.once('close', function () {\n      if (!self._ended) {\n        self.response.emit('end')\n      }\n    })\n\n    response.once('end', function () {\n      self._ended = true\n    })\n\n    var noBody = function (code) {\n      return (\n        self.method === 'HEAD' ||\n        // Informational\n        (code >= 100 && code < 200) ||\n        // No Content\n        code === 204 ||\n        // Not Modified\n        code === 304\n      )\n    }\n\n    var responseContent\n    if ((self.gzip || self.brotli) && !noBody(response.statusCode)) {\n      var contentEncoding = response.headers['content-encoding'] || 'identity'\n      contentEncoding = contentEncoding.trim().toLowerCase()\n\n      // Be more lenient with decoding compressed responses, since (very rarely)\n      // servers send slightly invalid gzip responses that are still accepted\n      // by common browsers.\n      // Always using Z_SYNC_FLUSH is what cURL does.\n      var zlibOptions = {\n        flush: zlib.Z_SYNC_FLUSH,\n        finishFlush: zlib.Z_SYNC_FLUSH\n      }\n\n      if (self.gzip && contentEncoding === 'gzip') {\n        responseContent = zlib.createGunzip(zlibOptions)\n        response.pipe(responseContent)\n      } else if (self.gzip && contentEncoding === 'deflate') {\n        responseContent = inflate.createInflate(zlibOptions)\n        response.pipe(responseContent)\n      } else if (self.brotli && contentEncoding === 'br') {\n        responseContent = brotli.createBrotliDecompress()\n        response.pipe(responseContent)\n      } else {\n        // Since previous versions didn't check for Content-Encoding header,\n        // ignore any invalid values to preserve backwards-compatibility\n        if (contentEncoding !== 'identity') {\n          debug('ignoring unrecognized Content-Encoding ' + contentEncoding)\n        }\n        responseContent = response\n      }\n    } else {\n      responseContent = response\n    }\n\n    if (self.encoding) {\n      if (self.dests.length !== 0) {\n        console.error('Ignoring encoding parameter as this stream is being piped to another stream which makes the encoding option invalid.')\n      } else {\n        responseContent.setEncoding(self.encoding)\n      }\n    }\n\n    // Node by default returns the status message with `latin1` character encoding,\n    // which results in characters lying outside the range of `U+0000 to U+00FF` getting truncated\n    // so that they can be mapped in the given range.\n    // Refer: https://nodejs.org/docs/latest-v12.x/api/buffer.html#buffer_buffers_and_character_encodings\n    //\n    // Exposing `statusMessageEncoding` option to make encoding type configurable.\n    // This would help in correctly representing status messages belonging to range outside of `latin1`\n    //\n    // @note: The Regex `[^\\w\\s-']` is tested to prevent unnecessary computation of creating a Buffer and\n    // then decoding it when the status message consists of common characters,\n    // specifically belonging to the following set: [a-z, A-Z, 0-9, -, _ ', whitespace]\n    // As in that case, no matter what the encoding type is used for decoding the buffer, the result would remain the same.\n    //\n    // @note: Providing a value in this option will result in force re-encoding of the status message\n    // which may not always be intended by the server - specifically in cases where\n    // server returns a status message which when encoded again with a different character encoding\n    // results in some other characters.\n    // For example: If the server intentionally responds with `ð\\x9F\\x98\\x8A` as status message\n    // but if the statusMessageEncoding option is set to `utf8`, then it would get converted to '😊'.\n    var statusMessage = String(responseContent.statusMessage)\n    if (self.statusMessageEncoding && /[^\\w\\s-']/.test(statusMessage)) {\n      responseContent.statusMessage = Buffer.from(statusMessage, 'latin1').toString(self.statusMessageEncoding)\n    }\n\n    if (self._paused) {\n      responseContent.pause()\n    }\n\n    self.responseContent = responseContent\n\n    self.emit('response', response)\n\n    self.dests.forEach(function (dest) {\n      self.pipeDest(dest)\n    })\n\n    var responseThresholdEnabled = false\n    var responseBytesLeft\n\n    if (typeof self.maxResponseSize === 'number') {\n      responseThresholdEnabled = true\n      responseBytesLeft = self.maxResponseSize\n    }\n\n    responseContent.on('data', function (chunk) {\n      if (self.timing && !self.responseStarted) {\n        self.responseStartTime = (new Date()).getTime()\n\n        // NOTE: responseStartTime is deprecated in favor of .timings\n        response.responseStartTime = self.responseStartTime\n      }\n      // if response threshold is set, update the response bytes left to hit\n      // threshold. If exceeds, abort the request.\n      if (responseThresholdEnabled) {\n        responseBytesLeft -= chunk.length\n        if (responseBytesLeft < 0) {\n          self.emit('error', new Error('Maximum response size reached'))\n          self.destroy()\n          self.abort()\n          return\n        }\n      }\n      self._destdata = true\n      self.emit('data', chunk)\n    })\n    responseContent.once('end', function (chunk) {\n      self.emit('end', chunk)\n    })\n    responseContent.on('error', function (error) {\n      self.emit('error', error)\n    })\n    responseContent.on('close', function () { self.emit('close') })\n\n    if (self.callback) {\n      self.readResponseBody(response)\n    } else { // if no callback\n      self.on('end', function () {\n        if (self._aborted) {\n          debug('aborted', self.uri.href)\n          return\n        }\n        self.emit('complete', response)\n      })\n    }\n  }\n\n  function forEachAsync (items, fn, cb) {\n    !cb && (cb = function () { /* (ಠ_ಠ) */ })\n\n    if (!(Array.isArray(items) && fn)) { return cb() }\n\n    var index = 0\n    var totalItems = items.length\n    function next (err) {\n      if (err || index >= totalItems) {\n        return cb(err)\n      }\n\n      try {\n        fn.call(items, items[index++], next)\n      } catch (error) {\n        return cb(error)\n      }\n    }\n\n    if (!totalItems) { return cb() }\n\n    next()\n  }\n\n  var targetCookieJar = (self._jar && self._jar.setCookie) ? self._jar : globalCookieJar\n  var addCookie = function (cookie, cb) {\n    // set the cookie if it's domain in the URI's domain.\n    targetCookieJar.setCookie(cookie, self.uri, {ignoreError: true}, function () {\n      // swallow the error, don't fail the request because of cookie jar failure\n      cb()\n    })\n  }\n\n  response.caseless = caseless(response.headers)\n\n  if (response.caseless.has('set-cookie') && (!self._disableCookies)) {\n    var headerName = response.caseless.has('set-cookie')\n    if (Array.isArray(response.headers[headerName])) {\n      forEachAsync(response.headers[headerName], addCookie, function (err) {\n        if (err) { return self.emit('error', err) }\n\n        responseHandler()\n      })\n    } else {\n      addCookie(response.headers[headerName], responseHandler)\n    }\n  } else {\n    responseHandler()\n  }\n\n  debug('finish init function', self.uri.href)\n}\n\nRequest.prototype.readResponseBody = function (response) {\n  var self = this\n  debug('reading response\\'s body')\n  var buffers = []\n  var bufferLength = 0\n  var strings = []\n\n  self.on('data', function (chunk) {\n    if (!Buffer.isBuffer(chunk)) {\n      strings.push(chunk)\n    } else if (chunk.length) {\n      bufferLength += chunk.length\n      buffers.push(chunk)\n    }\n  })\n  self.on('end', function () {\n    debug('end event', self.uri.href)\n    if (self._aborted) {\n      debug('aborted', self.uri.href)\n      // `buffer` is defined in the parent scope and used in a closure it exists for the life of the request.\n      // This can lead to leaky behavior if the user retains a reference to the request object.\n      buffers = []\n      bufferLength = 0\n      return\n    }\n\n    if (bufferLength) {\n      debug('has body', self.uri.href, bufferLength)\n      response.body = Buffer.concat(buffers, bufferLength)\n      if (self.encoding !== null) {\n        response.body = response.body.toString(self.encoding)\n      }\n      // `buffer` is defined in the parent scope and used in a closure it exists for the life of the Request.\n      // This can lead to leaky behavior if the user retains a reference to the request object.\n      buffers = []\n      bufferLength = 0\n    } else if (strings.length) {\n      // The UTF8 BOM [0xEF,0xBB,0xBF] is converted to [0xFE,0xFF] in the JS UTC16/UCS2 representation.\n      // Strip this value out when the encoding is set to 'utf8', as upstream consumers won't expect it and it breaks JSON.parse().\n      if (self.encoding === 'utf8' && strings[0].length > 0 && strings[0][0] === '\\uFEFF') {\n        strings[0] = strings[0].substring(1)\n      }\n      response.body = strings.join('')\n    }\n\n    if (self._json) {\n      try {\n        response.body = JSON.parse(response.body, self._jsonReviver)\n      } catch (e) {\n        debug('invalid JSON received', self.uri.href)\n      }\n    }\n    debug('emitting complete', self.uri.href)\n    if (typeof response.body === 'undefined' && !self._json) {\n      response.body = self.encoding === null ? Buffer.alloc(0) : ''\n    }\n    self.emit('complete', response, response.body)\n  })\n}\n\nRequest.prototype.abort = function () {\n  var self = this\n  self._aborted = true\n\n  if (self.req) {\n    self.req.abort()\n  } else if (self.response) {\n    self.response.destroy()\n  }\n\n  self.clearTimeout()\n  self.emit('abort')\n}\n\nRequest.prototype.pipeDest = function (dest) {\n  var self = this\n  var response = self.response\n  // Called after the response is received\n  if (dest.headers && !dest.headersSent) {\n    if (response.caseless.has('content-type')) {\n      var ctname = response.caseless.has('content-type')\n      if (dest.setHeader) {\n        dest.setHeader(ctname, response.headers[ctname])\n      } else {\n        dest.headers[ctname] = response.headers[ctname]\n      }\n    }\n\n    if (response.caseless.has('content-length')) {\n      var clname = response.caseless.has('content-length')\n      if (dest.setHeader) {\n        dest.setHeader(clname, response.headers[clname])\n      } else {\n        dest.headers[clname] = response.headers[clname]\n      }\n    }\n  }\n  if (dest.setHeader && !dest.headersSent) {\n    for (var i in response.headers) {\n      // If the response content is being decoded, the Content-Encoding header\n      // of the response doesn't represent the piped content, so don't pass it.\n      if (!self.gzip || i !== 'content-encoding') {\n        dest.setHeader(i, response.headers[i])\n      }\n    }\n    dest.statusCode = response.statusCode\n  }\n  if (self.pipefilter) {\n    self.pipefilter(response, dest)\n  }\n}\n\nRequest.prototype.qs = function (q, clobber) {\n  var self = this\n  var base\n  if (!clobber && self.uri.query) {\n    base = self._qs.parse(self.uri.query)\n  } else {\n    base = {}\n  }\n\n  for (var i in q) {\n    base[i] = q[i]\n  }\n\n  var qs = self._qs.stringify(base)\n\n  if (qs === '') {\n    return self\n  }\n\n  self.uri = self.urlParser.parse(self.uri.href.split('?')[0] + '?' + qs)\n  self.url = self.uri\n  self.path = self.uri.path\n\n  if (self.uri.host === 'unix') {\n    self.enableUnixSocket()\n  }\n\n  return self\n}\nRequest.prototype.form = function (form) {\n  var self = this\n  var contentType = self.getHeader('content-type')\n  var overrideInvalidContentType = contentType ? !self.allowContentTypeOverride : true\n  if (form) {\n    if (overrideInvalidContentType && !/^application\\/x-www-form-urlencoded\\b/.test(contentType)) {\n      self.setHeader('Content-Type', 'application/x-www-form-urlencoded')\n    }\n    self.body = (typeof form === 'string')\n      ? self._qs.rfc3986(form.toString('utf8'))\n      : self._qs.stringify(form).toString('utf8')\n    return self\n  }\n  // form-data\n  var contentTypeMatch = contentType && contentType.match &&\n    contentType.match(/^multipart\\/form-data;.*boundary=(?:\"([^\"]+)\"|([^;]+))/)\n  var boundary = contentTypeMatch && (contentTypeMatch[1] || contentTypeMatch[2])\n  // create form-data object\n  // set custom boundary if present in content-type else auto-generate\n  self._form = new FormData({ _boundary: boundary })\n  self._form.on('error', function (err) {\n    err.message = 'form-data: ' + err.message\n    self.emit('error', err)\n    self.abort()\n  })\n  if (overrideInvalidContentType && !contentTypeMatch) {\n    // overrides invalid or missing content-type\n    self.setHeader('Content-Type', 'multipart/form-data; boundary=' + self._form.getBoundary())\n  }\n  return self._form\n}\nRequest.prototype.multipart = function (multipart) {\n  var self = this\n\n  self._multipart.onRequest(multipart)\n\n  if (!self._multipart.chunked) {\n    self.body = self._multipart.body\n  }\n\n  return self\n}\nRequest.prototype.json = function (val) {\n  var self = this\n\n  if (!self.hasHeader('accept')) {\n    self.setHeader('Accept', 'application/json')\n  }\n\n  if (typeof self.jsonReplacer === 'function') {\n    self._jsonReplacer = self.jsonReplacer\n  }\n\n  self._json = true\n  if (typeof val === 'boolean') {\n    if (self.body !== undefined) {\n      if (!/^application\\/x-www-form-urlencoded\\b/.test(self.getHeader('content-type'))) {\n        self.body = safeStringify(self.body, self._jsonReplacer)\n      } else {\n        self.body = self._qs.rfc3986(self.body)\n      }\n      if (!self.hasHeader('content-type')) {\n        self.setHeader('Content-Type', 'application/json')\n      }\n    }\n  } else {\n    self.body = safeStringify(val, self._jsonReplacer)\n    if (!self.hasHeader('content-type')) {\n      self.setHeader('Content-Type', 'application/json')\n    }\n  }\n\n  if (typeof self.jsonReviver === 'function') {\n    self._jsonReviver = self.jsonReviver\n  }\n\n  return self\n}\nRequest.prototype.getHeader = function (name, headers) {\n  var self = this\n  var result, re, match\n  if (!headers) {\n    headers = self.headers\n  }\n  Object.keys(headers).forEach(function (key) {\n    if (key.length !== name.length) {\n      return\n    }\n    re = new RegExp(name, 'i')\n    match = key.match(re)\n    if (match) {\n      result = headers[key]\n    }\n  })\n  return result\n}\nRequest.prototype.enableUnixSocket = function () {\n  // Get the socket & request paths from the URL\n  var unixParts = this.uri.path.split(':')\n  var host = unixParts[0]\n  var path = unixParts[1]\n  // Apply unix properties to request\n  this.socketPath = host\n  this.uri.pathname = path\n  this.uri.path = path\n  this.uri.host = host\n  this.uri.hostname = host\n  this.uri.isUnix = true\n}\n\nRequest.prototype.auth = function (user, pass, sendImmediately, bearer) {\n  var self = this\n\n  self._auth.onRequest(user, pass, sendImmediately, bearer)\n\n  return self\n}\nRequest.prototype.aws = function (opts, now) {\n  var self = this\n\n  if (!now) {\n    self._aws = opts\n    return self\n  }\n\n  if (opts.sign_version === 4 || opts.sign_version === '4') {\n    // use aws4\n    var options = {\n      host: self.uri.host,\n      path: self.uri.path,\n      method: self.method,\n      headers: self.headers,\n      body: self.body\n    }\n    if (opts.service) {\n      options.service = opts.service\n    }\n    var signRes = aws4.sign(options, {\n      accessKeyId: opts.key,\n      secretAccessKey: opts.secret,\n      sessionToken: opts.session\n    })\n    self.setHeader('Authorization', signRes.headers.Authorization)\n    self.setHeader('X-Amz-Date', signRes.headers['X-Amz-Date'])\n    if (signRes.headers['X-Amz-Security-Token']) {\n      self.setHeader('X-Amz-Security-Token', signRes.headers['X-Amz-Security-Token'])\n    }\n  } else {\n    // default: use aws-sign2\n    var date = new Date()\n    self.setHeader('Date', date.toUTCString())\n    var auth = {\n      key: opts.key,\n      secret: opts.secret,\n      verb: self.method.toUpperCase(),\n      date: date,\n      contentType: self.getHeader('content-type') || '',\n      md5: self.getHeader('content-md5') || '',\n      amazonHeaders: aws2.canonicalizeHeaders(self.headers)\n    }\n    var path = self.uri.path\n    if (opts.bucket && path) {\n      auth.resource = '/' + opts.bucket + path\n    } else if (opts.bucket && !path) {\n      auth.resource = '/' + opts.bucket\n    } else if (!opts.bucket && path) {\n      auth.resource = path\n    } else if (!opts.bucket && !path) {\n      auth.resource = '/'\n    }\n    auth.resource = aws2.canonicalizeResource(auth.resource)\n    self.setHeader('Authorization', aws2.authorization(auth))\n  }\n\n  return self\n}\nRequest.prototype.httpSignature = function (opts) {\n  var self = this\n  httpSignature.signRequest({\n    getHeader: function (header) {\n      return self.getHeader(header, self.headers)\n    },\n    setHeader: function (header, value) {\n      self.setHeader(header, value)\n    },\n    method: self.method,\n    path: self.path\n  }, opts)\n  debug('httpSignature authorization', self.getHeader('authorization'))\n\n  return self\n}\nRequest.prototype.hawk = function (opts) {\n  var self = this\n  self.setHeader('Authorization', hawk.header(self.uri, self.method, opts))\n}\nRequest.prototype.oauth = function (_oauth) {\n  var self = this\n\n  self._oauth.onRequest(_oauth)\n\n  return self\n}\n\nRequest.prototype.jar = function (jar, cb) {\n  var self = this\n  self._jar = jar\n\n  if (!jar) {\n    // disable cookies\n    self._disableCookies = true\n    return cb()\n  }\n\n  if (self._redirect.redirectsFollowed === 0) {\n    self.originalCookieHeader = self.getHeader('cookie')\n  }\n\n  var targetCookieJar = jar.getCookieString ? jar : globalCookieJar\n  // fetch cookie in the Specified host\n  targetCookieJar.getCookieString(self.uri, function (err, cookies) {\n    if (err) { return cb() }\n\n    // if need cookie and cookie is not empty\n    if (cookies && cookies.length) {\n      if (self.originalCookieHeader) {\n        if (Array.isArray(self.originalCookieHeader)) {\n          self.originalCookieHeader = self.originalCookieHeader.join('; ')\n        }\n        // Don't overwrite existing Cookie header\n        self.setHeader('Cookie', self.originalCookieHeader + '; ' + cookies)\n      } else {\n        self.setHeader('Cookie', cookies)\n      }\n    }\n\n    cb()\n  })\n}\n\n// Stream API\nRequest.prototype.pipe = function (dest, opts) {\n  var self = this\n\n  if (self.response) {\n    if (self._destdata) {\n      self.emit('error', new Error('You cannot pipe after data has been emitted from the response.'))\n    } else if (self._ended) {\n      self.emit('error', new Error('You cannot pipe after the response has been ended.'))\n    } else {\n      stream.Stream.prototype.pipe.call(self, dest, opts)\n      self.pipeDest(dest)\n      return dest\n    }\n  } else {\n    self.dests.push(dest)\n    stream.Stream.prototype.pipe.call(self, dest, opts)\n    return dest\n  }\n}\nRequest.prototype.write = function () {\n  var self = this\n  if (self._aborted) { return }\n\n  if (!self._started) {\n    self.start()\n  }\n  if (self.req) {\n    return self.req.write.apply(self.req, arguments)\n  }\n}\nRequest.prototype.end = function (chunk) {\n  var self = this\n  if (self._aborted) { return }\n\n  if (chunk) {\n    self.write(chunk)\n  }\n  if (!self._started) {\n    self.start()\n  }\n  if (self.req) {\n    self.req.end()\n\n    self.req._header && (self._reqResInfo.request.headers = parseRequestHeaders(self.req._header))\n  }\n}\nRequest.prototype.pause = function () {\n  var self = this\n  if (!self.responseContent) {\n    self._paused = true\n  } else {\n    self.responseContent.pause.apply(self.responseContent, arguments)\n  }\n}\nRequest.prototype.resume = function () {\n  var self = this\n  if (!self.responseContent) {\n    self._paused = false\n  } else {\n    self.responseContent.resume.apply(self.responseContent, arguments)\n  }\n}\nRequest.prototype.destroy = function () {\n  var self = this\n  this.clearTimeout()\n  if (!self._ended) {\n    self.end()\n  } else if (self.response) {\n    self.response.destroy()\n  }\n}\n\nRequest.prototype.clearTimeout = function () {\n  if (this.timeoutTimer) {\n    clearTimeout(this.timeoutTimer)\n    this.timeoutTimer = null\n  }\n}\n\nRequest.defaultProxyHeaderWhiteList =\n  Tunnel.defaultProxyHeaderWhiteList.slice()\n\nRequest.defaultProxyHeaderExclusiveList =\n  Tunnel.defaultProxyHeaderExclusiveList.slice()\n\n// Exports\n\nRequest.prototype.toJSON = requestToJSON\nmodule.exports = Request\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}