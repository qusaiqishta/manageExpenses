{"ast":null,"code":"const _ = require('lodash'),\n  env = require('./environment');\nlet cache, bundler, cacher;\n\n// we first try and load the pre-bundled file from file-cache. file cache might be absent during development phase and\n// as such, we fall back to live bundling.\ntry {\n  bundler = require('../.cache/bootcode');\n} catch (e) {\n  console && console.info('sandbox: ' + e.message + '\\n' + 'bootcode is being live compiled. use `npm run cache` to use cached variant.');\n}\n\n// in case bundler is not a valid function, we create a bundler that uses the environment to compile sandbox bootstrap\n// code\n!_.isFunction(bundler) && (bundler = function (done) {\n  require('./bundle').load(env).compile(done);\n});\ncacher = function (done) {\n  // in case the cache is already populated, we simply forward the cached string to the caller\n  if (cache) {\n    return done(null, cache);\n  }\n\n  // since the code is not cached, we fetch the code from the bundler (it could be file cached or live compiled) and\n  // then cache it before forwarding it to caller.\n  bundler(function (err, code) {\n    if (err) {\n      return done(err);\n    }\n\n    // ensure buffer is stringified before being cached\n    code && !_.isString(code) && (code = code.toString());\n    if (code && _.isString(code)) {\n      // before caching we check the code as string once more\n      cache = code;\n      cacher.cached = true; // a flag to aid debugging\n    }\n\n    return done(null, cache);\n  });\n};\nmodule.exports = cacher;","map":{"version":3,"names":["_","require","env","cache","bundler","cacher","e","console","info","message","isFunction","done","load","compile","err","code","isString","toString","cached","module","exports"],"sources":["/Users/Qusai.Qishta/node_modules/postman-sandbox/lib/bootcode.js"],"sourcesContent":["const _ = require('lodash'),\n    env = require('./environment');\n\nlet cache,\n    bundler,\n    cacher;\n\n// we first try and load the pre-bundled file from file-cache. file cache might be absent during development phase and\n// as such, we fall back to live bundling.\ntry {\n    bundler = require('../.cache/bootcode');\n}\ncatch (e) {\n    console && console.info('sandbox: ' + e.message + '\\n' +\n        'bootcode is being live compiled. use `npm run cache` to use cached variant.');\n}\n\n// in case bundler is not a valid function, we create a bundler that uses the environment to compile sandbox bootstrap\n// code\n!_.isFunction(bundler) && (bundler = function (done) {\n    require('./bundle').load(env).compile(done);\n});\n\ncacher = function (done) {\n    // in case the cache is already populated, we simply forward the cached string to the caller\n    if (cache) {\n        return done(null, cache);\n    }\n\n    // since the code is not cached, we fetch the code from the bundler (it could be file cached or live compiled) and\n    // then cache it before forwarding it to caller.\n    bundler(function (err, code) {\n        if (err) { return done(err); }\n\n        // ensure buffer is stringified before being cached\n        (code && !_.isString(code)) && (code = code.toString());\n        if (code && _.isString(code)) { // before caching we check the code as string once more\n            cache = code;\n            cacher.cached = true; // a flag to aid debugging\n        }\n\n        return done(null, cache);\n    });\n};\n\nmodule.exports = cacher;\n"],"mappings":"AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAC,QAAQ,CAAC;EACvBC,GAAG,GAAGD,OAAO,CAAC,eAAe,CAAC;AAElC,IAAIE,KAAK,EACLC,OAAO,EACPC,MAAM;;AAEV;AACA;AACA,IAAI;EACAD,OAAO,GAAGH,OAAO,CAAC,oBAAoB,CAAC;AAC3C,CAAC,CACD,OAAOK,CAAC,EAAE;EACNC,OAAO,IAAIA,OAAO,CAACC,IAAI,CAAC,WAAW,GAAGF,CAAC,CAACG,OAAO,GAAG,IAAI,GAClD,6EAA6E,CAAC;AACtF;;AAEA;AACA;AACA,CAACT,CAAC,CAACU,UAAU,CAACN,OAAO,CAAC,KAAKA,OAAO,GAAG,UAAUO,IAAI,EAAE;EACjDV,OAAO,CAAC,UAAU,CAAC,CAACW,IAAI,CAACV,GAAG,CAAC,CAACW,OAAO,CAACF,IAAI,CAAC;AAC/C,CAAC,CAAC;AAEFN,MAAM,GAAG,UAAUM,IAAI,EAAE;EACrB;EACA,IAAIR,KAAK,EAAE;IACP,OAAOQ,IAAI,CAAC,IAAI,EAAER,KAAK,CAAC;EAC5B;;EAEA;EACA;EACAC,OAAO,CAAC,UAAUU,GAAG,EAAEC,IAAI,EAAE;IACzB,IAAID,GAAG,EAAE;MAAE,OAAOH,IAAI,CAACG,GAAG,CAAC;IAAE;;IAE7B;IACCC,IAAI,IAAI,CAACf,CAAC,CAACgB,QAAQ,CAACD,IAAI,CAAC,KAAMA,IAAI,GAAGA,IAAI,CAACE,QAAQ,EAAE,CAAC;IACvD,IAAIF,IAAI,IAAIf,CAAC,CAACgB,QAAQ,CAACD,IAAI,CAAC,EAAE;MAAE;MAC5BZ,KAAK,GAAGY,IAAI;MACZV,MAAM,CAACa,MAAM,GAAG,IAAI,CAAC,CAAC;IAC1B;;IAEA,OAAOP,IAAI,CAAC,IAAI,EAAER,KAAK,CAAC;EAC5B,CAAC,CAAC;AACN,CAAC;AAEDgB,MAAM,CAACC,OAAO,GAAGf,MAAM"},"metadata":{},"sourceType":"script"}